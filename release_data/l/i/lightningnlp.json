{
    "1.0.0": {
        "info": {
            "author": "xusenlin",
            "author_email": "1659821119@qq.com",
            "bugtrack_url": null,
            "classifiers": [],
            "description": "<div align=\"center\">\r\n\r\n**\u57fa\u4e8e [`pytorch-lightning`](https://github.com/Lightning-AI/lightning) \u548c [`transformers`](https://github.com/huggingface/transformers) \u6846\u67b6\u5b9e\u73b0\u5404\u7c7b `NLP` \u4efb\u52a1**\r\n\r\n</div>\r\n\r\n---\r\n\r\n## \u5b89\u88c5\r\n\r\n1. \u642d\u5efa\u597d `pytorch GPU` \u6df1\u5ea6\u5b66\u4e60\u73af\u5883\r\n\r\n```bash\r\nconda create -n pytorch python=3.8\r\nconda activate pytorch\r\nconda install pytorch cudatoolkit -c pytorch\r\n```\r\n\r\n2. \u5b89\u88c5\u9700\u8981\u7528\u5230\u7684\u4e00\u4e9b `python` \u5305\r\n\r\n```bash\r\npip install -r requirements.txt\r\n```\r\n\r\n3. \u5b89\u88c5 `lightningnlp`\r\n\r\n```bash\r\npip install lightningnlp\r\n```\r\n\r\n4. \u5728 `https://pytorch-geometric.com/whl/` \u4e2d\u627e\u5230\u4e0e `torch` \u7248\u672c\u5bf9\u5e94\u7684 `torch_scatter` \u5b89\u88c5\u5305\uff0c\u4e0b\u8f7d\u540e\u4f7f\u7528 `pip` \u5b89\u88c5 \r\n\r\n## \u6587\u672c\u5206\u7c7b\r\n\r\n### 1. \u6570\u636e\u8f6c\u6362\r\n\r\n<details>\r\n<summary>\u8bad\u7ec3\u6570\u636e\u793a\u4f8b</summary>\r\n\r\n```json\r\n{\r\n  \"text\": \"\u4ee5\u8272\u5217\u5927\u89c4\u6a21\u7a7a\u88ad\u5f00\u59cb\uff01\u4f0a\u6717\u591a\u4e2a\u519b\u4e8b\u76ee\u6807\u906d\u9047\u6253\u51fb\uff0c\u8a93\u8a00\u5bf9\u7b49\u53cd\u51fb\",\r\n  \"label\": \"news_military\"\r\n}\r\n```\r\n\r\n\r\n</details>\r\n\r\n### 2. \u6a21\u578b\r\n\r\n\r\n| \u6a21\u578b                                                        | \u8bba\u6587                                                                                                           | \u5907\u6ce8                              |\r\n|-----------------------------------------------------------|--------------------------------------------------------------------------------------------------------------|---------------------------------|\r\n| [FC](lightningnlp/task/text_classification/fc/model.py)   |                                                                                                              | \u5168\u8fde\u63a5\u5c42\u5206\u7c7b                          |\r\n| [MDP](lightningnlp/task/text_classification/mdp/model.py) | [Multi-Sample Dropout for Accelerated Training and Better Generalization.](https://arxiv.org/abs/1905.09788) | \u4f7f\u7528 `MultiSampleDropout`\uff0c\u7c7b\u4f3c\u4e8e\u6a21\u578b\u878d\u5408 |\r\n\r\n<details>\r\n<summary>\u8bad\u7ec3\u4ee3\u7801\u793a\u4f8b</summary>\r\n\r\n```python\r\nimport pytorch_lightning as pl\r\nfrom pytorch_lightning.loggers import WandbLogger\r\nfrom transformers import BertTokenizerFast\r\n\r\nfrom lightningnlp.callbacks import LoggingCallback\r\nfrom lightningnlp.task.text_classification import (\r\n    TextClassificationDataModule,\r\n    TextClassificationTransformer,\r\n)\r\n\r\npl.seed_everything(seed=42)\r\npretrained_model_name_or_path = \"hfl/chinese-roberta-wwm-ext\"  # \u9884\u8bad\u7ec3\u6a21\u578b\r\ntokenizer = BertTokenizerFast.from_pretrained(pretrained_model_name_or_path)\r\n\r\ndm = TextClassificationDataModule(\r\n    tokenizer=tokenizer,\r\n    train_batch_size=16,  # \u8bad\u7ec3\u96c6batch_size\r\n    validation_batch_size=16,  # \u9a8c\u8bc1\u96c6batch_size\r\n    num_workers=16,  # \u591a\u8fdb\u7a0b\u52a0\u8f7d\u6570\u636e\r\n    dataset_name=\"datasets/sentiment\",  # \u8bad\u7ec3\u6570\u636e\u6240\u5728\u76ee\u5f55\r\n    train_file=\"train.json\",  # \u8bad\u7ec3\u96c6\u6587\u4ef6\u540d\r\n    validation_file=\"dev.json\",  # \u9a8c\u8bc1\u96c6\u6587\u4ef6\u540d\r\n    max_length=256,  # \u5e8f\u5217\u6700\u5927\u957f\u5ea6\r\n    cache_dir=\"datasets/sentiment\",  # \u6570\u636e\u7f13\u5b58\u8def\u5f84\r\n    is_chinese=True,\r\n)\r\n\r\nmodel = TextClassificationTransformer(\r\n    downstream_model_name=\"fc\",  # \u6a21\u578b\u540d\u79f0\r\n    downstream_model_type=\"bert\",  # \u9884\u8bad\u7ec3\u6a21\u578b\u7c7b\u578b\r\n    pretrained_model_name_or_path=pretrained_model_name_or_path,\r\n    tokenizer=tokenizer,\r\n    label_map=dm.num_classes,\r\n    learning_rate=2e-5,\r\n    output_dir=\"outputs/sentiment/fc\",  # \u6a21\u578b\u4fdd\u5b58\u8def\u5f84\r\n)\r\n\r\nmodel_ckpt = pl.callbacks.ModelCheckpoint(\r\n    dirpath=\"outputs/sentiment/fc\",\r\n    filename=\"best_model\",\r\n    monitor=\"val_accuracy\",\r\n    save_top_k=1,\r\n    mode=\"max\",\r\n)\r\n\r\nwandb_logger = WandbLogger(project=\"Text Classification\", name=\"fc\")\r\n\r\ntrainer = pl.Trainer(\r\n    logger=wandb_logger,\r\n    accelerator=\"gpu\",\r\n    devices=1,\r\n    max_epochs=12,\r\n    val_check_interval=0.5,\r\n    gradient_clip_val=1.0,\r\n    callbacks=[model_ckpt, LoggingCallback()]\r\n)\r\n\r\ntrainer.fit(model, dm)\r\n```\r\n\r\n</details>\r\n\r\n### 3. \u9884\u6d4b\r\n\r\n```python\r\nfrom lightningnlp.task.text_classification import TextClassificationTransformer\r\n\r\nmodel = TextClassificationTransformer.load_from_checkpoint(\"my_bert_model_path\")\r\ntext = \"\u4ee5\u8272\u5217\u5927\u89c4\u6a21\u7a7a\u88ad\u5f00\u59cb\uff01\u4f0a\u6717\u591a\u4e2a\u519b\u4e8b\u76ee\u6807\u906d\u9047\u6253\u51fb\uff0c\u8a93\u8a00\u5bf9\u7b49\u53cd\u51fb\"\r\nprint(model.predict(text))\r\n```\r\n\r\n---\r\n\r\n## \u547d\u540d\u5b9e\u4f53\u8bc6\u522b\r\n\r\n### 1. \u6570\u636e\u8f6c\u6362\r\n\r\n<details>\r\n<summary>\u8bad\u7ec3\u6570\u636e\u793a\u4f8b</summary>\r\n\r\n```json\r\n{\r\n  \"text\": \"\u7ed3\u679c\u4e0a\u5468\u516d\u4ed6\u4eec\u4e3b\u573a0\uff1a3\u60e8\u8d25\u7ed9\u4e86\u4e2d\u6e38\u7403\u961f\u74e6\u62c9\u591a\u5229\u5fb7\uff0c\u8fd17\u4e2a\u591a\u6708\u4ee5\u6765\u897f\u7532\u9996\u6b21\u8f93\u7403\u3002\", \r\n  \"entities\": [\r\n    {\r\n      \"id\": 0, \r\n      \"entity\": \"\u74e6\u62c9\u591a\u5229\u5fb7\", \r\n      \"start_offset\": 20, \r\n      \"end_offset\": 25, \r\n      \"label\": \"organization\"\r\n    }, \r\n    {\r\n      \"id\": 1, \r\n      \"entity\": \"\u897f\u7532\", \r\n      \"start_offset\": 33, \r\n      \"end_offset\": 35, \r\n      \"label\": \"organization\"\r\n    }\r\n  ]\r\n}\r\n```\r\n</details>\r\n\r\n\r\n### 2. \u6a21\u578b\r\n\r\n\r\n| \u6a21\u578b                                                                                   | \u8bba\u6587                                                                                                                                                                            | \u5907\u6ce8                                                                                                                                            |\r\n|--------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------|\r\n| [SOFTMAX](lightningnlp/task/named_entity_recognition/crf/model.py)                   |                                                                                                                                                                               | \u5168\u8fde\u63a5\u5c42\u5e8f\u5217\u6807\u6ce8\u5e76\u4f7f\u7528 `BIO` \u89e3\u7801                                                                                                                          |\r\n| [CRF](lightningnlp/task/named_entity_recognition/crf/model.py)                       | [Conditional Random Fields: Probabilistic Models for Segmenting and Labeling Sequence Data](https://repository.upenn.edu/cgi/viewcontent.cgi?article=1162&context=cis_papers) | \u5168\u8fde\u63a5\u5c42+\u6761\u4ef6\u968f\u673a\u573a\uff0c\u5e76\u4f7f\u7528 `BIO` \u89e3\u7801                                                                                                                       |\r\n| [CASCADE-CRF](lightningnlp/task/named_entity_recognition/crf/model.py)               |                                                                                                                                                                               | \u5148\u9884\u6d4b\u5b9e\u4f53\u518d\u9884\u6d4b\u5b9e\u4f53\u7c7b\u578b                                                                                                                                  |\r\n| [SPAN](lightningnlp/task/named_entity_recognition/span/model.py)                     |                                                                                                                                                                               | \u4f7f\u7528\u4e24\u4e2a\u6307\u9488\u7f51\u7edc\u9884\u6d4b\u5b9e\u4f53\u8d77\u59cb\u4f4d\u7f6e                                                                                                                              |\r\n| [GLOBAL-POINTER](lightningnlp/task/named_entity_recognition/global_pointer/model.py) |                                                                                                                                                                               | [GlobalPointer\uff1a\u7528\u7edf\u4e00\u7684\u65b9\u5f0f\u5904\u7406\u5d4c\u5957\u548c\u975e\u5d4c\u5957NER](https://spaces.ac.cn/archives/8373)\u3001[Efficient GlobalPointer\uff1a\u5c11\u70b9\u53c2\u6570\uff0c\u591a\u70b9\u6548\u679c](https://spaces.ac.cn/archives/8877) |\r\n| [MRC](lightningnlp/task/named_entity_recognition/mrc/model.py)                       | [A Unified MRC Framework for Named Entity Recognition.](https://aclanthology.org/2020.acl-main.519.pdf)                                                                       | \u5c06\u5b9e\u4f53\u8bc6\u522b\u4efb\u52a1\u8f6c\u6362\u4e3a\u9605\u8bfb\u7406\u89e3\u95ee\u9898\uff0c\u8f93\u5165\u4e3a\u5b9e\u4f53\u7c7b\u578b\u6a21\u677f+\u53e5\u5b50\uff0c\u9884\u6d4b\u5bf9\u5e94\u5b9e\u4f53\u7684\u8d77\u59cb\u4f4d\u7f6e                                                                                                     |\r\n| [TPLINKER](lightningnlp/task/named_entity_recognition/tplinker/model.py)             | [TPLinker: Single-stage Joint Extraction of Entities and Relations Through Token Pair Linking.](https://aclanthology.org/2020.coling-main.138.pdf)                            | \u5c06\u5b9e\u4f53\u8bc6\u522b\u4efb\u52a1\u8f6c\u6362\u4e3a\u8868\u683c\u586b\u5145\u95ee\u9898                                                                                                                              |\r\n| [LEAR](lightningnlp/task/named_entity_recognition/lear/model.py)                     | [Enhanced Language Representation with Label Knowledge for Span Extraction.](https://aclanthology.org/2021.emnlp-main.379.pdf)                                                | \u6539\u8fdb `MRC` \u65b9\u6cd5\u6548\u7387\u95ee\u9898\uff0c\u91c7\u7528\u6807\u7b7e\u878d\u5408\u673a\u5236                                                                                                                      |\r\n| [W2NER](lightningnlp/task/named_entity_recognition/w2ner/model.py)                   | [Unified Named Entity Recognition as Word-Word Relation Classification.](https://arxiv.org/pdf/2112.10070.pdf)                                                                | \u7edf\u4e00\u89e3\u51b3\u5d4c\u5957\u5b9e\u4f53\u3001\u4e0d\u8fde\u7eed\u5b9e\u4f53\u7684\u62bd\u53d6\u95ee\u9898                                                                                                                           |\r\n| [CNN-NER](lightningnlp/task/named_entity_recognition/cnn/model.py)                   | [Unified Named Entity Recognition as Word-Word Relation Classification.](https://arxiv.org/pdf/2112.10070.pdf)                                                                | \u6539\u8fdb `W2NER` \u65b9\u6cd5\uff0c\u91c7\u7528\u5377\u79ef\u7f51\u7edc\u63d0\u53d6\u5b9e\u4f53\u5185\u90e8token\u4e4b\u95f4\u7684\u5173\u7cfb                                                                                                          |\r\n\r\n<details>\r\n<summary>\u8bad\u7ec3\u4ee3\u7801\u793a\u4f8b</summary>\r\n\r\n```python\r\nimport pytorch_lightning as pl\r\nfrom pytorch_lightning.loggers import WandbLogger\r\nfrom transformers import BertTokenizerFast\r\n\r\nfrom lightningnlp.callbacks import LoggingCallback\r\nfrom lightningnlp.task.named_entity_recognition import (\r\n    CRFNerDataModule,\r\n    NamedEntityRecognitionTransformer,\r\n)\r\n\r\npl.seed_everything(seed=42)\r\npretrained_model_name_or_path = \"hfl/chinese-roberta-wwm-ext\"  # \u9884\u8bad\u7ec3\u6a21\u578b\r\ntokenizer = BertTokenizerFast.from_pretrained(pretrained_model_name_or_path)\r\n\r\ndm = CRFNerDataModule(\r\n    tokenizer=tokenizer,\r\n    train_batch_size=16,  # \u8bad\u7ec3\u96c6batch_size\r\n    validation_batch_size=16,  # \u9a8c\u8bc1\u96c6batch_size\r\n    num_workers=16,  # \u591a\u8fdb\u7a0b\u52a0\u8f7d\u6570\u636e\r\n    dataset_name=\"datasets/cmeee\",  # \u8bad\u7ec3\u6570\u636e\u6240\u5728\u76ee\u5f55\r\n    train_file=\"train.json\",  # \u8bad\u7ec3\u96c6\u6587\u4ef6\u540d\r\n    validation_file=\"dev.json\",  # \u9a8c\u8bc1\u96c6\u6587\u4ef6\u540d\r\n    max_length=128,  # \u5e8f\u5217\u6700\u5927\u957f\u5ea6\r\n    cache_dir=\"datasets/cmeee\",  # \u6570\u636e\u7f13\u5b58\u8def\u5f84\r\n    task_name=\"cmeee-bert-crf\",  # \u81ea\u5b9a\u4e49\u4efb\u52a1\u540d\u79f0\r\n    is_chinese=True,\r\n)\r\n\r\nmodel = NamedEntityRecognitionTransformer(\r\n    downstream_model_name=\"crf\",  # \u6a21\u578b\u540d\u79f0\r\n    downstream_model_type=\"bert\",  # \u9884\u8bad\u7ec3\u6a21\u578b\u7c7b\u578b\r\n    pretrained_model_name_or_path=pretrained_model_name_or_path,\r\n    tokenizer=tokenizer,\r\n    labels=dm.label_list,\r\n    learning_rate=2e-5,\r\n    average=\"micro\",\r\n    output_dir=\"outputs/cmeee/crf\",  # \u6a21\u578b\u4fdd\u5b58\u8def\u5f84\r\n)\r\n\r\nmodel_ckpt = pl.callbacks.ModelCheckpoint(\r\n    dirpath=\"outputs/cmeee/crf\",\r\n    filename=\"best_model\",\r\n    monitor=\"val_f1_micro\",\r\n    save_top_k=1,\r\n    mode=\"max\",\r\n)\r\n\r\nwandb_logger = WandbLogger(project=\"Named Entity Recognition\", name=\"cmeee-bert-crf\")\r\n\r\ntrainer = pl.Trainer(\r\n    logger=wandb_logger,\r\n    accelerator=\"gpu\",\r\n    devices=1,\r\n    max_epochs=12,\r\n    val_check_interval=0.5,\r\n    gradient_clip_val=1.0,\r\n    callbacks=[model_ckpt, LoggingCallback()]\r\n)\r\n\r\ntrainer.fit(model, dm)\r\n```\r\n\r\n</details>\r\n\r\n### 3. \u9884\u6d4b\r\n\r\n```python\r\nfrom pprint import pprint\r\nfrom lightningnlp.task.named_entity_recognition import NerPipeline\r\n\r\npipline = NerPipeline(model_name_or_path=\"my_bert_model_path\", model_name=\"crf\", model_type=\"bert\")\r\ntext = \"\u7ed3\u679c\u4e0a\u5468\u516d\u4ed6\u4eec\u4e3b\u573a0\uff1a3\u60e8\u8d25\u7ed9\u4e86\u4e2d\u6e38\u7403\u961f\u74e6\u62c9\u591a\u5229\u5fb7\uff0c\u8fd17\u4e2a\u591a\u6708\u4ee5\u6765\u897f\u7532\u9996\u6b21\u8f93\u7403\u3002\"\r\npprint(pipline(text))\r\n```\r\n\r\n### 4. APP\u5e94\u7528\r\n\r\n![ner](./images/ner.png)\r\n\r\n---\r\n\r\n## \u5b9e\u4f53\u5173\u7cfb\u62bd\u53d6\r\n\r\n### 1. \u6570\u636e\u8f6c\u6362\r\n\r\n<details>\r\n<summary>\u8bad\u7ec3\u6570\u636e\u793a\u4f8b</summary>\r\n\r\n```json\r\n{\r\n  \"text\": \"\u67e5\u5c14\u65af\u00b7\u963f\u5170\u57fa\u65af\uff08Charles Ar\u00e1nguiz\uff09\uff0c1989\u5e744\u670817\u65e5\u51fa\u751f\u4e8e\u667a\u5229\u5723\u5730\u4e9a\u54e5\uff0c\u667a\u5229\u804c\u4e1a\u8db3\u7403\u8fd0\u52a8\u5458\uff0c\u53f8\u804c\u4e2d\u573a\uff0c\u6548\u529b\u4e8e\u5fb7\u56fd\u8db3\u7403\u7532\u7ea7\u8054\u8d5b\u52d2\u6c83\u5e93\u68ee\u8db3\u7403\u4ff1\u4e50\u90e8\", \r\n  \"spo_list\": [\r\n    {\r\n      \"predicate\": \"\u51fa\u751f\u5730\", \r\n      \"object_type\": \"\u5730\u70b9\", \r\n      \"subject_type\": \"\u4eba\u7269\", \r\n      \"object\": \"\u5723\u5730\u4e9a\u54e5\", \r\n      \"subject\": \"\u67e5\u5c14\u65af\u00b7\u963f\u5170\u57fa\u65af\"\r\n    }, \r\n    {\r\n      \"predicate\": \"\u51fa\u751f\u65e5\u671f\", \r\n      \"object_type\": \"Date\", \r\n      \"subject_type\": \"\u4eba\u7269\", \r\n      \"object\": \"1989\u5e744\u670817\u65e5\",\r\n      \"subject\": \"\u67e5\u5c14\u65af\u00b7\u963f\u5170\u57fa\u65af\"\r\n    }\r\n  ]\r\n}\r\n```\r\n\r\n</details>\r\n\r\n\r\n### 2. \u6a21\u578b\r\n\r\n| \u6a21\u578b                                                                  | \u8bba\u6587                                                                                                                                                 | \u5907\u6ce8                                                                  |\r\n|---------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------|\r\n| [CASREL](lightningnlp/task/relation_extraction/casrel/model.py)     | [A Novel Cascade Binary Tagging Framework for Relational Triple Extraction.](https://aclanthology.org/2020.acl-main.136.pdf)                       | \u4e24\u9636\u6bb5\u5173\u7cfb\u62bd\u53d6\uff0c\u5148\u62bd\u53d6\u51fa\u53e5\u5b50\u4e2d\u7684\u4e3b\u8bed\uff0c\u518d\u901a\u8fc7\u6307\u9488\u7f51\u7edc\u62bd\u53d6\u51fa\u4e3b\u8bed\u5bf9\u5e94\u7684\u5173\u7cfb\u548c\u5bbe\u8bed                             |\r\n| [TPLINKER](lightningnlp/task/relation_extraction/tplinker/model.py) | [TPLinker: Single-stage Joint Extraction of Entities and Relations Through Token Pair Linking.](https://aclanthology.org/2020.coling-main.138.pdf) | \u5c06\u5173\u7cfb\u62bd\u53d6\u95ee\u9898\u8f6c\u6362\u4e3a\u4e3b\u8bed-\u5bbe\u8bed\u7684\u9996\u5c3e\u8fde\u63a5\u95ee\u9898                                              |\r\n| [SPN](lightningnlp/task/relation_extraction/spn/model.py)           | [Joint Entity and Relation Extraction with Set Prediction Networks.](http://xxx.itp.ac.cn/pdf/2011.01675v2)                                        | \u5c06\u5173\u7cfb\u62bd\u53d6\u95ee\u9898\u8f6c\u4e3a\u4e3a\u4e09\u5143\u7ec4\u7684\u96c6\u5408\u9884\u6d4b\u95ee\u9898\uff0c\u91c7\u7528 `Encoder-Decoder` \u6846\u67b6                        |\r\n| [PRGC](lightningnlp/task/relation_extraction/prgc/model.py)         | [PRGC: Potential Relation and Global Correspondence Based Joint Relational Triple Extraction.](https://aclanthology.org/2021.acl-long.486.pdf)     | \u5148\u62bd\u53d6\u53e5\u5b50\u7684\u6f5c\u5728\u5173\u7cfb\u7c7b\u578b\uff0c\u7136\u540e\u5bf9\u4e8e\u7ed9\u5b9a\u5173\u7cfb\u62bd\u53d6\u51fa\u5bf9\u5e94\u7684\u4e3b\u8bed-\u5bbe\u8bed\u5bf9\uff0c\u6700\u540e\u901a\u8fc7\u5168\u5c40\u5bf9\u9f50\u6a21\u5757\u8fc7\u6ee4                      |\r\n| [PFN](lightningnlp/task/relation_extraction/pfn/model.py)           | [A Partition Filter Network for Joint Entity and Relation Extraction.](https://aclanthology.org/2021.emnlp-main.17.pdf)                            | \u91c7\u7528\u7c7b\u4f3c  `LSTM`  \u7684\u5206\u533a\u8fc7\u6ee4\u673a\u5236\uff0c\u5c06\u9690\u85cf\u5c42\u4fe1\u606f\u5206\u6210\u5b9e\u4f53\u8bc6\u522b\u3001\u5173\u7cfb\u8bc6\u522b\u548c\u5171\u4eab\u4e09\u90e8\u5206\uff0c\u5bf9\u4e0e\u4e0d\u540c\u7684\u4efb\u52a1\u5229\u7528\u4e0d\u540c\u7684\u4fe1\u606f        |\r\n| [GRTE](lightningnlp/task/relation_extraction/grte/model.py)         | [A Novel Global Feature-Oriented Relational Triple Extraction Model based on Table Filling.](https://aclanthology.org/2021.emnlp-main.208.pdf)     | \u5c06\u5173\u7cfb\u62bd\u53d6\u95ee\u9898\u8f6c\u6362\u4e3a\u5355\u8bcd\u5bf9\u7684\u5206\u7c7b\u95ee\u9898\uff0c\u57fa\u4e8e\u5168\u5c40\u7279\u5f81\u62bd\u53d6\u6a21\u5757\u5faa\u73af\u4f18\u5316\u5355\u8bcd\u5bf9\u7684\u5411\u91cf\u8868\u793a                           |\r\n| [GPLINKER](lightningnlp/task/relation_extraction/gplinker/model.py) |                                                                                                                                                    | [GPLinker\uff1a\u57fa\u4e8eGlobalPointer\u7684\u5b9e\u4f53\u5173\u7cfb\u8054\u5408\u62bd\u53d6](https://kexue.fm/archives/8888) |\r\n\r\n\r\n<details>\r\n<summary>\u8bad\u7ec3\u4ee3\u7801\u793a\u4f8b</summary>\r\n\r\n```python\r\nimport pytorch_lightning as pl\r\nfrom pytorch_lightning.loggers import WandbLogger\r\nfrom transformers import BertTokenizerFast\r\n\r\nfrom lightningnlp.callbacks import LoggingCallback\r\nfrom lightningnlp.task.relation_extraction import (\r\n    GPLinkerDataModule,\r\n    RelationExtractionTransformer,\r\n)\r\n\r\npl.seed_everything(seed=42)\r\npretrained_model_name_or_path = \"hfl/chinese-roberta-wwm-ext\"  # \u9884\u8bad\u7ec3\u6a21\u578b\r\ntokenizer = BertTokenizerFast.from_pretrained(pretrained_model_name_or_path)\r\n\r\ndm = GPLinkerDataModule(\r\n    tokenizer=tokenizer,\r\n    train_batch_size=16,  # \u8bad\u7ec3\u96c6batch_size\r\n    validation_batch_size=16,  # \u9a8c\u8bc1\u96c6batch_size\r\n    num_workers=16,  # \u591a\u8fdb\u7a0b\u52a0\u8f7d\u6570\u636e\r\n    dataset_name=\"datasets/duie\",  # \u8bad\u7ec3\u6570\u636e\u6240\u5728\u76ee\u5f55\r\n    train_file=\"train.json\",  # \u8bad\u7ec3\u96c6\u6587\u4ef6\u540d\r\n    validation_file=\"dev.json\",  # \u9a8c\u8bc1\u96c6\u6587\u4ef6\u540d\r\n    max_length=128,  # \u5e8f\u5217\u6700\u5927\u957f\u5ea6\r\n    cache_dir=\"datasets/duie\",  # \u6570\u636e\u7f13\u5b58\u8def\u5f84\r\n    task_name=\"duie-bert-gplinker\",  # \u81ea\u5b9a\u4e49\u4efb\u52a1\u540d\u79f0\r\n    is_chinese=True,\r\n)\r\n\r\nmodel = RelationExtractionTransformer(\r\n    downstream_model_name=\"gplinker\",  # \u6a21\u578b\u540d\u79f0\r\n    downstream_model_type=\"bert\",  # \u9884\u8bad\u7ec3\u6a21\u578b\u7c7b\u578b\r\n    pretrained_model_name_or_path=pretrained_model_name_or_path,\r\n    tokenizer=tokenizer,\r\n    predicates=dm.predicate_list,\r\n    learning_rate=2e-5,\r\n    average=\"micro\",\r\n    output_dir=\"outputs/duie/gplinker\",  # \u6a21\u578b\u4fdd\u5b58\u8def\u5f84\r\n)\r\n\r\nmodel_ckpt = pl.callbacks.ModelCheckpoint(\r\n    dirpath=\"outputs/duie/gplinker\",\r\n    filename=\"best_model\",\r\n    monitor=\"val_f1_micro\",\r\n    save_top_k=1,\r\n    mode=\"max\",\r\n)\r\n\r\nwandb_logger = WandbLogger(project=\"Relation Extraction\", name=\"duie-bert-gplinker\")\r\n\r\ntrainer = pl.Trainer(\r\n    logger=wandb_logger,\r\n    accelerator=\"gpu\",\r\n    devices=1,\r\n    max_epochs=12,\r\n    val_check_interval=0.5,\r\n    gradient_clip_val=1.0,\r\n    callbacks=[model_ckpt, LoggingCallback()]\r\n)\r\n\r\ntrainer.fit(model, dm)\r\n```\r\n\r\n</details>\r\n\r\n### 3. \u9884\u6d4b\r\n\r\n```python\r\nfrom pprint import pprint\r\nfrom lightningnlp.task.relation_extraction import RelationExtractionPipeline\r\n\r\npipline = RelationExtractionPipeline(model_name_or_path=\"my_bert_model_path\", model_name=\"gplinker\", model_type=\"bert\")\r\ntext = \"\u67e5\u5c14\u65af\u00b7\u963f\u5170\u57fa\u65af\uff08Charles Ar\u00e1nguiz\uff09\uff0c1989\u5e744\u670817\u65e5\u51fa\u751f\u4e8e\u667a\u5229\u5723\u5730\u4e9a\u54e5\uff0c\u667a\u5229\u804c\u4e1a\u8db3\u7403\u8fd0\u52a8\u5458\uff0c\u53f8\u804c\u4e2d\u573a\uff0c\u6548\u529b\u4e8e\u5fb7\u56fd\u8db3\u7403\u7532\u7ea7\u8054\u8d5b\u52d2\u6c83\u5e93\u68ee\u8db3\u7403\u4ff1\u4e50\u90e8\u3002\"\r\npprint(pipline(text))\r\n```\r\n\r\n---\r\n\r\n### 4. APP\u5e94\u7528\r\n\r\n![re](./images/re.png)\r\n\r\n## Citation\r\n\u5982\u679c `LightningNLP` \u5bf9\u60a8\u7684\u7814\u7a76\u6709\u5e2e\u52a9\uff0c\u6b22\u8fce\u5f15\u7528\r\n\r\n```text\r\n@misc{=lightningnlp,\r\n    title={LightningNLP: An Easy-to-use NLP Library},\r\n    author={senlin xu},\r\n    howpublished = {\\url{https://github.com/xusenlinzy/lightningblocks}},\r\n    year={2022}\r\n}\r\n```\r\n\r\n## Acknowledge\r\n\r\n\u6211\u4eec\u501f\u9274\u4e86[`Lightning-transformers`](https://github.com/Lightning-AI/lightning-transformers) \u5173\u4e8e\u6a21\u578b\u4f7f\u7528\u7684\u4f18\u79c0\u8bbe\u8ba1\uff0c\u5728\u6b64\u5bf9`Lightning-transformers` \u4f5c\u8005\u53ca\u5176\u5f00\u6e90\u793e\u533a\u8868\u793a\u611f\u8c22\u3002\r\n\r\n",
            "description_content_type": "text/markdown",
            "docs_url": null,
            "download_url": "",
            "downloads": {
                "last_day": -1,
                "last_month": -1,
                "last_week": -1
            },
            "home_page": "https://github.com/xusenlinzy/lightningblocks",
            "keywords": "",
            "license": "MIT Licence",
            "maintainer": "",
            "maintainer_email": "",
            "name": "lightningnlp",
            "package_url": "https://pypi.org/project/lightningnlp/",
            "platform": null,
            "project_url": "https://pypi.org/project/lightningnlp/",
            "project_urls": {
                "Homepage": "https://github.com/xusenlinzy/lightningblocks"
            },
            "release_url": "https://pypi.org/project/lightningnlp/1.0.0/",
            "requires_dist": null,
            "requires_python": ">=3.7",
            "summary": "Pytorch-lightning Code Blocks for NLP",
            "version": "1.0.0",
            "yanked": false,
            "yanked_reason": null
        },
        "last_serial": 15966674,
        "urls": [
            {
                "comment_text": "",
                "digests": {
                    "md5": "4f01c7b75a1568a13172048c5ba40a5e",
                    "sha256": "9d4f3b4578569e24aaa9039c2f1d55912776b32906d8d0b34ef108ace388b76d"
                },
                "downloads": -1,
                "filename": "lightningnlp-1.0.0.tar.gz",
                "has_sig": false,
                "md5_digest": "4f01c7b75a1568a13172048c5ba40a5e",
                "packagetype": "sdist",
                "python_version": "source",
                "requires_python": ">=3.7",
                "size": 228821,
                "upload_time": "2022-12-02T06:12:48",
                "upload_time_iso_8601": "2022-12-02T06:12:48.840404Z",
                "url": "https://files.pythonhosted.org/packages/af/bf/c5386cab8b7e8038f72b2945678f17414564a7cdcd02bee76f67e29639c1/lightningnlp-1.0.0.tar.gz",
                "yanked": false,
                "yanked_reason": null
            }
        ],
        "vulnerabilities": []
    }
}