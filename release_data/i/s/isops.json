{
    "0.1.0": {
        "info": {
            "author": "Lorenzo Maffioli",
            "author_email": "lorenzo.maffioli@gmail.com",
            "bugtrack_url": null,
            "classifiers": [
                "Programming Language :: Python :: 3",
                "Programming Language :: Python :: 3.10",
                "Programming Language :: Python :: 3.11",
                "Programming Language :: Python :: 3.7",
                "Programming Language :: Python :: 3.8",
                "Programming Language :: Python :: 3.9"
            ],
            "description": "# IsOPS: **Is** **OP**erations **S**ecure\n\n[![codecov](https://codecov.io/gh/lorenzophys/isops/branch/main/graph/badge.svg?token=7RQ5P3X22D)](https://codecov.io/gh/lorenzophys/isops)\n![tests](https://img.shields.io/github/actions/workflow/status/lorenzophys/isops/test-workflow?branch=main&label=tests)\n![pver](https://img.shields.io/pypi/pyversions/isops)\n![MIT](https://img.shields.io/github/license/lorenzophys/isops)\n\n```ascii\n__/\\\\\\\\\\\\\\\\\\\\\\____________________/\\\\\\\\\\_______/\\\\\\\\\\\\\\\\\\\\\\\\\\_______/\\\\\\\\\\\\\\\\\\\\\\___        \n _\\/////\\\\\\///___________________/\\\\\\///\\\\\\____\\/\\\\\\/////////\\\\\\___/\\\\\\/////////\\\\\\_       \n  _____\\/\\\\\\____________________/\\\\\\/__\\///\\\\\\__\\/\\\\\\_______\\/\\\\\\__\\//\\\\\\______\\///__      \n   _____\\/\\\\\\______/\\\\\\\\\\\\\\\\\\\\__/\\\\\\______\\//\\\\\\_\\/\\\\\\\\\\\\\\\\\\\\\\\\\\/____\\////\\\\\\_________     \n    _____\\/\\\\\\_____\\/\\\\\\//////__\\/\\\\\\_______\\/\\\\\\_\\/\\\\\\/////////_________\\////\\\\\\______    \n     _____\\/\\\\\\_____\\/\\\\\\\\\\\\\\\\\\\\_\\//\\\\\\______/\\\\\\__\\/\\\\\\_____________________\\////\\\\\\___   \n      _____\\/\\\\\\_____\\////////\\\\\\__\\///\\\\\\__/\\\\\\____\\/\\\\\\______________/\\\\\\______\\//\\\\\\__  \n       __/\\\\\\\\\\\\\\\\\\\\\\__/\\\\\\\\\\\\\\\\\\\\____\\///\\\\\\\\\\/_____\\/\\\\\\_____________\\///\\\\\\\\\\\\\\\\\\\\\\/___ \n        _\\///////////__\\//////////_______\\/////_______\\///________________\\///////////_____\n\n```\n\nIsOPS (**Is** **OP**erations **S**ecure) is a minimal command line utility that helps you ensure that your secrets are encrypted correctly with [sops](https://github.com/mozilla/sops) before committing them. `isops` will read your configuration files, will scan all your secrets and alerts you if it finds any key that should be encrypted but it's not.\n\n## CLI\n\n```console\nuser@laptop:~$ isops\nUsage: isops [OPTIONS] PATH\n\n  Top level command.\n\nOptions:\n  -h, --help           Show this message and exit.\n  --version            Show the version and exit.\n  --config-regex TEXT  The regex that matches all the config files to use.\n                       [required]\n```\n\nYou must provide a directory to scan and a regex that matches all the sops configuration files.\n\n## How it works?\n\n`isops` is called with a directory and a regex. Then:\n\n1. It finds the config files using the provided regex.\n2. For each rule in `creation_rules` it finds the files according to the `path_regex`.\n3. For each file found, `isops` scans all the keys, no matter how nested the yaml is, in search for those keys that match the `encrypted_regex`.\n4. For each matched key, it checks if the associated value matches the sops regex `\"^ENC\\[AES256_GCM,data:(.+),iv:(.+),tag:(.+),type:(.+)\\]\"`.\n\nIf the config file doesn't provide a `path_regex` or a `encrypted_regex`, the default values are, respectively, `\"\\.ya?ml$\"` and `\"\"`.\n\n## Usage example\n\nSuppose you have this situation:\n\n```text\nexample\n\u251c\u2500\u2500 .sops.yaml\n\u2514\u2500\u2500 secret.yaml\n```\n\nA `.sops.yaml`:\n\n```yaml\ncreation_rules:\n  - path_regex: (.*)?secret.yaml$\n    encrypted_regex: \"^(data|stringData)$\"\n    pgp: \"FBC7B9E2A4F9289AC0C1D4843D16CEE4A27381B4\"\n```\n\nand a `secret.yaml`:\n\n```yaml\napiVersion: v1\ndata:\n  key: aGhkZDg4OGRoODRmaDQ4ZmJlbnNta21rbHdtc2k4\nkind: Secret\nmetadata:\n  name: api-key\ntype: Opaque\n```\n\nIf you run `isops` you get a warning because your secret is not encrypted:\n\n```console\nuser@laptop:~$ isops ./example --config-regex .sops.yaml\nFound config file: example/.sops.yaml\nexample/secret.yaml::key [UNSAFE]\nuser@laptop:~$ echo $?\n1\n```\n\nIf the same secret is encrypted with sops:\n\n```yaml\napiVersion: v1\ndata:\n    key: ENC[AES256_GCM,data:iCBh27Ort/dNVhP9D4y/AqI5d78U+2EHtHPX9u0/s9ANhA2VeqKSOQ==,iv:HkQVUgB6nvN3TU355K/PTU2NroahHAdoJhzJdgZFMwo=,tag:ayNppVmYJ/MLGrW9RtjV1A==,type:str]\nkind: Secret\nmetadata:\n    name: api-key\ntype: Opaque\nsops:\n    etc...\n\n```\n\nthen `isops` will give you the green light:\n\n```console\nuser@laptop:~$ isops ./example --config-regex .sops.yaml\nFound config file: example/.sops.yaml\nexample/secret.yaml::key [SAFE]\nuser@laptop:~$ echo $?\n0\n```\n\n## Another example\n\nYou can have a more complicated scenario where there are multiple sops configuration files, multiple environments and lots of secrets.\n\nSuppose you have this situation:\n\n```text\nexample\n\u251c\u2500\u2500 .sops\n\u2502   \u251c\u2500\u2500 sops-dev.yaml\n\u2502   \u2514\u2500\u2500 sops-prod.yaml\n\u251c\u2500\u2500 dev\n\u2502   \u251c\u2500\u2500 api-key-secret.yaml        <- Encrypted\n\u2502   \u251c\u2500\u2500 db-password-secret.yaml    <- Encrypted\n\u2502   \u251c\u2500\u2500 deployment.yaml\n\u2502   \u2514\u2500\u2500 service.yaml\n\u2514\u2500\u2500 prod\n    \u251c\u2500\u2500 api-key-secret.yaml        <- Not encrypted!\n    \u251c\u2500\u2500 db-password-secret.yaml    <- Encrypted\n    \u251c\u2500\u2500 deployment.yaml\n    \u2514\u2500\u2500 service.yaml\n```\n\nThen if you run `isops` you get:\n\n```console\nuser@laptop:~$ isops example --config-regex \"example/.sops/(.*).yaml$\"\nFound config file: example/.sops/sops-dev.yaml\nFound config file: example/.sops/sops-prod.yaml\nexample/dev/db-password-secret.yaml::password [SAFE]\nexample/dev/api-key-secret.yaml::key [SAFE]\nexample/prod/db-password-secret.yaml::password [SAFE]\nexample/prod/api-key-secret.yaml::key [UNSAFE]\n```\n\nThe previous example can be found in the `example` directory. The sample application was generated by [ChatGPT](https://chat.openai.com/chat) with the prompt: \"Please, generate an example Kubernetes application with two secrets\".\n\n## License\n\nThis project is licensed under the **MIT License** - see the *LICENSE* file for details.\n",
            "description_content_type": "text/markdown",
            "docs_url": null,
            "download_url": "",
            "downloads": {
                "last_day": -1,
                "last_month": -1,
                "last_week": -1
            },
            "home_page": "https://github.com/lorenzophys/isops",
            "keywords": "isops,sops,secrets",
            "license": "",
            "maintainer": "",
            "maintainer_email": "",
            "name": "isops",
            "package_url": "https://pypi.org/project/isops/",
            "platform": null,
            "project_url": "https://pypi.org/project/isops/",
            "project_urls": {
                "Homepage": "https://github.com/lorenzophys/isops",
                "Repository": "https://github.com/lorenzophys/isops"
            },
            "release_url": "https://pypi.org/project/isops/0.1.0/",
            "requires_dist": [
                "click (>=8.1.3,<9.0.0)",
                "ruamel-yaml (>=0.17.21,<0.18.0)"
            ],
            "requires_python": ">=3.7,<4.0",
            "summary": "Utility to ensure SOPS secrets are encrypterd.",
            "version": "0.1.0",
            "yanked": false,
            "yanked_reason": null
        },
        "last_serial": 16197893,
        "urls": [
            {
                "comment_text": "",
                "digests": {
                    "md5": "36eb23b7855256cbda3ea9a9b22e8760",
                    "sha256": "1e60e91c9a866cff3895a512f62ae22d6ba0949e53184eff49f13a5d814b4e21"
                },
                "downloads": -1,
                "filename": "isops-0.1.0-py3-none-any.whl",
                "has_sig": false,
                "md5_digest": "36eb23b7855256cbda3ea9a9b22e8760",
                "packagetype": "bdist_wheel",
                "python_version": "py3",
                "requires_python": ">=3.7,<4.0",
                "size": 7530,
                "upload_time": "2022-12-23T14:35:47",
                "upload_time_iso_8601": "2022-12-23T14:35:47.864985Z",
                "url": "https://files.pythonhosted.org/packages/8b/25/dcdbfa984549e72444f4d170e90a40664eda4f33be63becfa029f6a2fc6b/isops-0.1.0-py3-none-any.whl",
                "yanked": false,
                "yanked_reason": null
            },
            {
                "comment_text": "",
                "digests": {
                    "md5": "ce854c9d38c01a92fc8f589449c9098c",
                    "sha256": "7537d847a93ee1e523878e630f9a893da8e2d99c89bc18d236a3042149d54468"
                },
                "downloads": -1,
                "filename": "isops-0.1.0.tar.gz",
                "has_sig": false,
                "md5_digest": "ce854c9d38c01a92fc8f589449c9098c",
                "packagetype": "sdist",
                "python_version": "source",
                "requires_python": ">=3.7,<4.0",
                "size": 7673,
                "upload_time": "2022-12-23T14:35:49",
                "upload_time_iso_8601": "2022-12-23T14:35:49.254511Z",
                "url": "https://files.pythonhosted.org/packages/14/d9/8f6860d709877ef8de69660c18be82207a0150438d5c3b3895c12428ee44/isops-0.1.0.tar.gz",
                "yanked": false,
                "yanked_reason": null
            }
        ],
        "vulnerabilities": []
    }
}