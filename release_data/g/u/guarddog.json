{
    "0.1.1": {
        "info": {
            "author": "Ellen Wang",
            "author_email": "",
            "bugtrack_url": null,
            "classifiers": [
                "License :: Other/Proprietary License",
                "Programming Language :: Python :: 3",
                "Programming Language :: Python :: 3.10",
                "Programming Language :: Python :: 3.11"
            ],
            "description_content_type": "",
            "docs_url": null,
            "download_url": "",
            "downloads": {
                "last_day": -1,
                "last_month": -1,
                "last_week": -1
            },
            "home_page": "",
            "keywords": "",
            "license": "Apache 2.0",
            "maintainer": "",
            "maintainer_email": "",
            "name": "guarddog",
            "package_url": "https://pypi.org/project/guarddog/",
            "platform": null,
            "project_url": "https://pypi.org/project/guarddog/",
            "project_urls": null,
            "release_url": "https://pypi.org/project/guarddog/0.1.1/",
            "requires_dist": [
                "attrs (==21.4.0)",
                "boltons (==21.0.0)",
                "bracex (==2.3.post1)",
                "charset-normalizer (==2.1.0)",
                "click (==8.1.3)",
                "click-option-group (==0.5.3)",
                "colorama (==0.4.5)",
                "defusedxml (==0.7.1)",
                "docker (==6.0.0b1)",
                "face (==20.1.1)",
                "flake8 (>=5.0.4,<6.0.0)",
                "glom (==22.1.0)",
                "idna (==3.3)",
                "jsonschema (==4.9.1)",
                "mypy-extensions (==0.4.3)",
                "pathos (>=0.2.9,<0.3.0)",
                "pathspec (==0.9.0)",
                "platformdirs (==2.5.2)",
                "pyparsing (==3.0.9)",
                "pytest (>=7.1.2,<8.0.0)",
                "python-dateutil (==2.8.2)",
                "python-dotenv (==0.20.0)",
                "python-lsp-jsonrpc (==1.0.0)",
                "python-whois (>=0.8.0,<0.9.0)",
                "requests (==2.28.1)",
                "semgrep (==0.107.0)",
                "setuptools (>=65.6.3,<66.0.0)",
                "six (==1.16.0)",
                "termcolor (>=2.1.0,<3.0.0)",
                "tomli (==2.0.1)",
                "tqdm (==4.64.0)",
                "typing-extensions (==4.3.0)",
                "ujson (==5.4.0)",
                "urllib3 (==1.26.11)",
                "wcmatch (==8.4)",
                "websocket-client (==1.3.3)"
            ],
            "requires_python": ">=3.10,<4",
            "summary": "GuardDog is a CLI tool to Identify malicious PyPI packages",
            "version": "0.1.1",
            "yanked": false,
            "yanked_reason": null
        },
        "last_serial": 16072240,
        "urls": [
            {
                "comment_text": "",
                "digests": {
                    "md5": "daf6260b090b1defa54d6e41f6b53443",
                    "sha256": "da546e0c0e29b6802e107f8d6ef5e9540fce741ed1e85cbc551c9be4c38569c5"
                },
                "downloads": -1,
                "filename": "guarddog-0.1.1-py3-none-any.whl",
                "has_sig": false,
                "md5_digest": "daf6260b090b1defa54d6e41f6b53443",
                "packagetype": "bdist_wheel",
                "python_version": "py3",
                "requires_python": ">=3.10,<4",
                "size": 86635,
                "upload_time": "2022-11-28T09:27:58",
                "upload_time_iso_8601": "2022-11-28T09:27:58.368280Z",
                "url": "https://files.pythonhosted.org/packages/3d/bf/453105d4a7fddaf0bfdc733382794b0818b54dfa240b34d2681af4da3902/guarddog-0.1.1-py3-none-any.whl",
                "yanked": false,
                "yanked_reason": null
            },
            {
                "comment_text": "",
                "digests": {
                    "md5": "d2bc5098eac87b1beb27b5e4ce2a6ec3",
                    "sha256": "7baf0a177b5d3124ed9e84e4c7043fb3b09c603362b2cf9736ba425161941e89"
                },
                "downloads": -1,
                "filename": "guarddog-0.1.1.tar.gz",
                "has_sig": false,
                "md5_digest": "d2bc5098eac87b1beb27b5e4ce2a6ec3",
                "packagetype": "sdist",
                "python_version": "source",
                "requires_python": ">=3.10,<4",
                "size": 79545,
                "upload_time": "2022-11-28T09:28:00",
                "upload_time_iso_8601": "2022-11-28T09:28:00.883240Z",
                "url": "https://files.pythonhosted.org/packages/5d/00/abc05b072e4038972993eec45ec55842323ba0e629f73c0737a23d64f01c/guarddog-0.1.1.tar.gz",
                "yanked": false,
                "yanked_reason": null
            }
        ],
        "vulnerabilities": [
            {
                "aliases": [],
                "details": "### Impact\n\nRunning GuardDog against a specially-crafted package can allow an attacker to write an arbitrary file on the machine where GuardDog is executed.\n\nThis is due to a path traversal vulnerability when extracting the `.tar.gz` file of the package being scanned, which exists by design in the `tarfile.TarFile.extractall` function. See also https://docs.python.org/3/library/tarfile.html#tarfile.TarFile.extractall\n\n### Remediation\n\nUpgrade to GuardDog v0.1.5 or more recent.\n\n### References\n\n* https://semgrep.dev/r?q=trailofbits.python.tarfile-extractall-traversal.tarfile-extractall-traversal\n* https://www.trellix.com/en-us/about/newsroom/stories/research/tarfile-exploiting-the-world.html\n* https://docs.python.org/3/library/tarfile.html#tarfile.TarFile.extractall\n",
                "fixed_in": [
                    "0.1.5"
                ],
                "id": "GHSA-rp2v-v467-q9vq",
                "link": "https://osv.dev/vulnerability/GHSA-rp2v-v467-q9vq",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            },
            {
                "aliases": [],
                "details": "### Summary\n\nUnsafe extracting using `shutil.unpack_archive()` from a remotely retrieved tarball may lead to writing the extracted file to an unintended destination.\n\n### Details\n\nExtracting files using `shutil.unpack_archive()` from a potentially malicious tarball without validating that the destination file path is within the intended destination directory can cause files outside the destination directory to be overwritten.  \n\nThe vulnerable code snippet is between [L153..158](https://github.com/DataDog/guarddog/blob/a1d064ceb09d39bb28deb6972bc0a278756ea91f/guarddog/scanners/package_scanner.py#L153..158). \n\n```python\nresponse = requests.get(url, stream=True)\n\nwith open(zippath, \"wb\") as f:\n      f.write(response.raw.read())\n\nshutil.unpack_archive(zippath, unzippedpath)\n```\nIt seems that a remotely retrieved tarball which could be with the extension `.tar.gz` happens to be unpacked using `shutil.unpack_archive()` with no destination verification/limitation of the extracted files.\n\n### PoC\n\nThe PoC provided showcases the risk of extracting the non-harmless text file `sim4n6.txt` to a parent location rather than the current folder. \n\n```bash\n> tar --list -f archive.tar\ntar: Removing leading `../../../' from member names\n../../../sim4n6.txt\n\n> python3 \nPython 3.10.6 (main, Nov  2 2022, 18:53:38) [GCC 11.3.0] on linux\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n>>> import shutil\n>>> shutil.unpack_archive(\"archive.tar\")\n>>> exit()\n\n> file ../../../sim4n6.txt\n../../../sim4n6.txt: ASCII text\n```\n\n### A Potential Attack Scenario\n\n- An attacker may craft a malicious tarball with a filename path, such as `../../../../../../../../etc/passwd`, and then serve the archive remotely, thus, providing a possibility to overwrite the system files.\n\n### Mitigation\n\nPotential mitigation could be to:\n- Use a safer module, like `zipfile`.\n- Validate the location of the extracted files and discard those with malicious paths such as a relative path `..` or absolute ones. ",
                "fixed_in": [
                    "0.1.8"
                ],
                "id": "GHSA-78m5-jpmf-ch7v",
                "link": "https://osv.dev/vulnerability/GHSA-78m5-jpmf-ch7v",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            }
        ]
    },
    "0.1.10": {
        "info": {
            "author": "Ellen Wang",
            "author_email": "",
            "bugtrack_url": null,
            "classifiers": [
                "License :: OSI Approved :: Apache Software License",
                "Programming Language :: Python :: 3",
                "Programming Language :: Python :: 3.10",
                "Programming Language :: Python :: 3.11"
            ],
            "description_content_type": "text/x-rst",
            "docs_url": null,
            "download_url": "",
            "downloads": {
                "last_day": -1,
                "last_month": -1,
                "last_week": -1
            },
            "home_page": "https://github.com/DataDog/guarddog",
            "keywords": "",
            "license": "Apache-2.0",
            "maintainer": "",
            "maintainer_email": "",
            "name": "guarddog",
            "package_url": "https://pypi.org/project/guarddog/",
            "platform": null,
            "project_url": "https://pypi.org/project/guarddog/",
            "project_urls": {
                "Homepage": "https://github.com/DataDog/guarddog",
                "Repository": "https://github.com/DataDog/guarddog"
            },
            "release_url": "https://pypi.org/project/guarddog/0.1.10/",
            "requires_dist": [
                "attrs (==21.4.0)",
                "boltons (==21.0.0)",
                "bracex (==2.3.post1)",
                "charset-normalizer (==2.1.0)",
                "click (==8.1.3)",
                "click-option-group (==0.5.3)",
                "colorama (==0.4.5)",
                "defusedxml (==0.7.1)",
                "docker (==6.0.0b1)",
                "face (==20.1.1)",
                "flake8 (>=5.0.4,<6.0.0)",
                "glom (==22.1.0)",
                "idna (==3.3)",
                "jsonschema (==4.9.1)",
                "mypy-extensions (==0.4.3)",
                "pathos (>=0.2.9,<0.3.0)",
                "pathspec (==0.9.0)",
                "platformdirs (==2.5.2)",
                "pyparsing (==3.0.9)",
                "pytest (>=7.1.2,<8.0.0)",
                "python-dateutil (==2.8.2)",
                "python-dotenv (==0.20.0)",
                "python-lsp-jsonrpc (==1.0.0)",
                "python-whois (>=0.8.0,<0.9.0)",
                "requests (==2.28.1)",
                "semgrep (==0.112.1)",
                "setuptools (>=65.6.3,<66.0.0)",
                "six (==1.16.0)",
                "tarsafe (>=0.0.4,<0.0.5)",
                "termcolor (>=2.1.0,<3.0.0)",
                "tomli (==2.0.1)",
                "tqdm (==4.64.0)",
                "typing-extensions (==4.3.0)",
                "ujson (==5.4.0)",
                "urllib3 (==1.26.11)",
                "wcmatch (==8.4)",
                "websocket-client (==1.3.3)"
            ],
            "requires_python": ">=3.10",
            "summary": "GuardDog is a CLI tool to Identify malicious PyPI packages",
            "version": "0.1.10",
            "yanked": false,
            "yanked_reason": null
        },
        "last_serial": 16072240,
        "urls": [
            {
                "comment_text": "",
                "digests": {
                    "md5": "13d664b91ddc6bc50d57730faff64805",
                    "sha256": "6f093ea1102dd291c5c95caffec05d129e60f26614205d75962dab7c17c92319"
                },
                "downloads": -1,
                "filename": "guarddog-0.1.10-py3-none-any.whl",
                "has_sig": false,
                "md5_digest": "13d664b91ddc6bc50d57730faff64805",
                "packagetype": "bdist_wheel",
                "python_version": "py3",
                "requires_python": ">=3.10",
                "size": 88531,
                "upload_time": "2022-12-12T09:54:55",
                "upload_time_iso_8601": "2022-12-12T09:54:55.268779Z",
                "url": "https://files.pythonhosted.org/packages/02/95/bb41e25866e3b0072316a9d80cecc900dc3f42d2122a702600cbb6f473b7/guarddog-0.1.10-py3-none-any.whl",
                "yanked": false,
                "yanked_reason": null
            },
            {
                "comment_text": "",
                "digests": {
                    "md5": "275120c6685b250883ec4e7d62d1f503",
                    "sha256": "52f4684824bdf526cb4ebd1ef328d5da11207f2d2ce5e8e0dec0a15f32234eae"
                },
                "downloads": -1,
                "filename": "guarddog-0.1.10.tar.gz",
                "has_sig": false,
                "md5_digest": "275120c6685b250883ec4e7d62d1f503",
                "packagetype": "sdist",
                "python_version": "source",
                "requires_python": ">=3.10",
                "size": 80927,
                "upload_time": "2022-12-12T09:54:57",
                "upload_time_iso_8601": "2022-12-12T09:54:57.024975Z",
                "url": "https://files.pythonhosted.org/packages/66/bf/2c0a4a6630cefaa23f95d32e4e1c8e9ed3ed289e843b42adca3ce679acdd/guarddog-0.1.10.tar.gz",
                "yanked": false,
                "yanked_reason": null
            }
        ],
        "vulnerabilities": []
    },
    "0.1.3": {
        "info": {
            "author": "Ellen Wang",
            "author_email": "",
            "bugtrack_url": null,
            "classifiers": [
                "License :: OSI Approved :: Apache Software License",
                "Programming Language :: Python :: 3",
                "Programming Language :: Python :: 3.10",
                "Programming Language :: Python :: 3.11"
            ],
            "description_content_type": "text/x-rst",
            "docs_url": null,
            "download_url": "",
            "downloads": {
                "last_day": -1,
                "last_month": -1,
                "last_week": -1
            },
            "home_page": "",
            "keywords": "",
            "license": "Apache-2.0",
            "maintainer": "",
            "maintainer_email": "",
            "name": "guarddog",
            "package_url": "https://pypi.org/project/guarddog/",
            "platform": null,
            "project_url": "https://pypi.org/project/guarddog/",
            "project_urls": null,
            "release_url": "https://pypi.org/project/guarddog/0.1.3/",
            "requires_dist": [
                "attrs (==21.4.0)",
                "boltons (==21.0.0)",
                "bracex (==2.3.post1)",
                "charset-normalizer (==2.1.0)",
                "click (==8.1.3)",
                "click-option-group (==0.5.3)",
                "colorama (==0.4.5)",
                "defusedxml (==0.7.1)",
                "docker (==6.0.0b1)",
                "face (==20.1.1)",
                "flake8 (>=5.0.4,<6.0.0)",
                "glom (==22.1.0)",
                "idna (==3.3)",
                "jsonschema (==4.9.1)",
                "mypy-extensions (==0.4.3)",
                "pathos (>=0.2.9,<0.3.0)",
                "pathspec (==0.9.0)",
                "platformdirs (==2.5.2)",
                "pyparsing (==3.0.9)",
                "pytest (>=7.1.2,<8.0.0)",
                "python-dateutil (==2.8.2)",
                "python-dotenv (==0.20.0)",
                "python-lsp-jsonrpc (==1.0.0)",
                "python-whois (>=0.8.0,<0.9.0)",
                "requests (==2.28.1)",
                "semgrep (==0.107.0)",
                "setuptools (>=65.6.3,<66.0.0)",
                "six (==1.16.0)",
                "termcolor (>=2.1.0,<3.0.0)",
                "tomli (==2.0.1)",
                "tqdm (==4.64.0)",
                "typing-extensions (==4.3.0)",
                "ujson (==5.4.0)",
                "urllib3 (==1.26.11)",
                "wcmatch (==8.4)",
                "websocket-client (==1.3.3)"
            ],
            "requires_python": ">=3.10,<4",
            "summary": "GuardDog is a CLI tool to Identify malicious PyPI packages",
            "version": "0.1.3",
            "yanked": false,
            "yanked_reason": null
        },
        "last_serial": 16072240,
        "urls": [
            {
                "comment_text": "",
                "digests": {
                    "md5": "a397dba55dcc4624e343d9d171776e3b",
                    "sha256": "2b8b9e71e4de50e64687677c77872c6bf89905db457a3a5b5ad8041699c5fee1"
                },
                "downloads": -1,
                "filename": "guarddog-0.1.3-py3-none-any.whl",
                "has_sig": false,
                "md5_digest": "a397dba55dcc4624e343d9d171776e3b",
                "packagetype": "bdist_wheel",
                "python_version": "py3",
                "requires_python": ">=3.10,<4",
                "size": 86738,
                "upload_time": "2022-11-28T13:11:01",
                "upload_time_iso_8601": "2022-11-28T13:11:01.035754Z",
                "url": "https://files.pythonhosted.org/packages/59/d3/bd82d0b1b009dedcd3c6f8bb9f7b977580ef6ac501a757cda67b96fbc4f8/guarddog-0.1.3-py3-none-any.whl",
                "yanked": false,
                "yanked_reason": null
            },
            {
                "comment_text": "",
                "digests": {
                    "md5": "8d47053aadeb46e6613effd582f68d31",
                    "sha256": "166f8e503a237711f54fb3e47cf2635e0b674d6fd33b9f3bb7777635d26b8625"
                },
                "downloads": -1,
                "filename": "guarddog-0.1.3.tar.gz",
                "has_sig": false,
                "md5_digest": "8d47053aadeb46e6613effd582f68d31",
                "packagetype": "sdist",
                "python_version": "source",
                "requires_python": ">=3.10,<4",
                "size": 79409,
                "upload_time": "2022-11-28T13:11:02",
                "upload_time_iso_8601": "2022-11-28T13:11:02.327275Z",
                "url": "https://files.pythonhosted.org/packages/81/87/3f31134abdd568409921f94915826a597540b465b12bfc22354eb5d827a9/guarddog-0.1.3.tar.gz",
                "yanked": false,
                "yanked_reason": null
            }
        ],
        "vulnerabilities": [
            {
                "aliases": [],
                "details": "### Impact\n\nRunning GuardDog against a specially-crafted package can allow an attacker to write an arbitrary file on the machine where GuardDog is executed.\n\nThis is due to a path traversal vulnerability when extracting the `.tar.gz` file of the package being scanned, which exists by design in the `tarfile.TarFile.extractall` function. See also https://docs.python.org/3/library/tarfile.html#tarfile.TarFile.extractall\n\n### Remediation\n\nUpgrade to GuardDog v0.1.5 or more recent.\n\n### References\n\n* https://semgrep.dev/r?q=trailofbits.python.tarfile-extractall-traversal.tarfile-extractall-traversal\n* https://www.trellix.com/en-us/about/newsroom/stories/research/tarfile-exploiting-the-world.html\n* https://docs.python.org/3/library/tarfile.html#tarfile.TarFile.extractall\n",
                "fixed_in": [
                    "0.1.5"
                ],
                "id": "GHSA-rp2v-v467-q9vq",
                "link": "https://osv.dev/vulnerability/GHSA-rp2v-v467-q9vq",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            },
            {
                "aliases": [],
                "details": "### Summary\n\nUnsafe extracting using `shutil.unpack_archive()` from a remotely retrieved tarball may lead to writing the extracted file to an unintended destination.\n\n### Details\n\nExtracting files using `shutil.unpack_archive()` from a potentially malicious tarball without validating that the destination file path is within the intended destination directory can cause files outside the destination directory to be overwritten.  \n\nThe vulnerable code snippet is between [L153..158](https://github.com/DataDog/guarddog/blob/a1d064ceb09d39bb28deb6972bc0a278756ea91f/guarddog/scanners/package_scanner.py#L153..158). \n\n```python\nresponse = requests.get(url, stream=True)\n\nwith open(zippath, \"wb\") as f:\n      f.write(response.raw.read())\n\nshutil.unpack_archive(zippath, unzippedpath)\n```\nIt seems that a remotely retrieved tarball which could be with the extension `.tar.gz` happens to be unpacked using `shutil.unpack_archive()` with no destination verification/limitation of the extracted files.\n\n### PoC\n\nThe PoC provided showcases the risk of extracting the non-harmless text file `sim4n6.txt` to a parent location rather than the current folder. \n\n```bash\n> tar --list -f archive.tar\ntar: Removing leading `../../../' from member names\n../../../sim4n6.txt\n\n> python3 \nPython 3.10.6 (main, Nov  2 2022, 18:53:38) [GCC 11.3.0] on linux\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n>>> import shutil\n>>> shutil.unpack_archive(\"archive.tar\")\n>>> exit()\n\n> file ../../../sim4n6.txt\n../../../sim4n6.txt: ASCII text\n```\n\n### A Potential Attack Scenario\n\n- An attacker may craft a malicious tarball with a filename path, such as `../../../../../../../../etc/passwd`, and then serve the archive remotely, thus, providing a possibility to overwrite the system files.\n\n### Mitigation\n\nPotential mitigation could be to:\n- Use a safer module, like `zipfile`.\n- Validate the location of the extracted files and discard those with malicious paths such as a relative path `..` or absolute ones. ",
                "fixed_in": [
                    "0.1.8"
                ],
                "id": "GHSA-78m5-jpmf-ch7v",
                "link": "https://osv.dev/vulnerability/GHSA-78m5-jpmf-ch7v",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            }
        ]
    },
    "0.1.4": {
        "info": {
            "author": "Ellen Wang",
            "author_email": "",
            "bugtrack_url": null,
            "classifiers": [
                "License :: OSI Approved :: Apache Software License",
                "Programming Language :: Python :: 3",
                "Programming Language :: Python :: 3.10",
                "Programming Language :: Python :: 3.11",
                "Programming Language :: Python :: 3.9"
            ],
            "description_content_type": "text/x-rst",
            "docs_url": null,
            "download_url": "",
            "downloads": {
                "last_day": -1,
                "last_month": -1,
                "last_week": -1
            },
            "home_page": "",
            "keywords": "",
            "license": "Apache-2.0",
            "maintainer": "",
            "maintainer_email": "",
            "name": "guarddog",
            "package_url": "https://pypi.org/project/guarddog/",
            "platform": null,
            "project_url": "https://pypi.org/project/guarddog/",
            "project_urls": null,
            "release_url": "https://pypi.org/project/guarddog/0.1.4/",
            "requires_dist": [
                "attrs (==21.4.0)",
                "boltons (==21.0.0)",
                "bracex (==2.3.post1)",
                "charset-normalizer (==2.1.0)",
                "click (==8.1.3)",
                "click-option-group (==0.5.3)",
                "colorama (==0.4.5)",
                "defusedxml (==0.7.1)",
                "docker (==6.0.0b1)",
                "face (==20.1.1)",
                "flake8 (>=5.0.4,<6.0.0)",
                "glom (==22.1.0)",
                "idna (==3.3)",
                "jsonschema (==4.9.1)",
                "mypy-extensions (==0.4.3)",
                "pathos (>=0.2.9,<0.3.0)",
                "pathspec (==0.9.0)",
                "platformdirs (==2.5.2)",
                "pyparsing (==3.0.9)",
                "pytest (>=7.1.2,<8.0.0)",
                "python-dateutil (==2.8.2)",
                "python-dotenv (==0.20.0)",
                "python-lsp-jsonrpc (==1.0.0)",
                "python-whois (>=0.8.0,<0.9.0)",
                "requests (==2.28.1)",
                "semgrep (==0.122.0)",
                "setuptools (>=65.6.3,<66.0.0)",
                "six (==1.16.0)",
                "termcolor (>=2.1.0,<3.0.0)",
                "tomli (==2.0.1)",
                "tqdm (==4.64.0)",
                "typing-extensions (==4.3.0)",
                "ujson (==5.4.0)",
                "urllib3 (==1.26.11)",
                "wcmatch (==8.4)",
                "websocket-client (==1.3.3)"
            ],
            "requires_python": ">=3.9,<4",
            "summary": "GuardDog is a CLI tool to Identify malicious PyPI packages",
            "version": "0.1.4",
            "yanked": false,
            "yanked_reason": null
        },
        "last_serial": 16072240,
        "urls": [
            {
                "comment_text": "",
                "digests": {
                    "md5": "ab2d30609c05f241453e283c43eb9d3f",
                    "sha256": "fe3c5b62ef25cc415b7cd5248b6913d605d5e9860e42bad0509d238fc403fec1"
                },
                "downloads": -1,
                "filename": "guarddog-0.1.4-py3-none-any.whl",
                "has_sig": false,
                "md5_digest": "ab2d30609c05f241453e283c43eb9d3f",
                "packagetype": "bdist_wheel",
                "python_version": "py3",
                "requires_python": ">=3.9,<4",
                "size": 87150,
                "upload_time": "2022-11-28T16:10:02",
                "upload_time_iso_8601": "2022-11-28T16:10:02.740114Z",
                "url": "https://files.pythonhosted.org/packages/3e/f3/63dbf109e16ce6c5230f06b701dca67884d5b40f84cc82616d4e1579f221/guarddog-0.1.4-py3-none-any.whl",
                "yanked": false,
                "yanked_reason": null
            },
            {
                "comment_text": "",
                "digests": {
                    "md5": "97c11c2afd7ae05138fea4dcce634ad9",
                    "sha256": "811b2430eaa86610b2ff51a08e922c82f29c0010ebe543791fb7c44ec0bd2893"
                },
                "downloads": -1,
                "filename": "guarddog-0.1.4.tar.gz",
                "has_sig": false,
                "md5_digest": "97c11c2afd7ae05138fea4dcce634ad9",
                "packagetype": "sdist",
                "python_version": "source",
                "requires_python": ">=3.9,<4",
                "size": 79847,
                "upload_time": "2022-11-28T16:10:04",
                "upload_time_iso_8601": "2022-11-28T16:10:04.164805Z",
                "url": "https://files.pythonhosted.org/packages/a3/b9/fb0d824db92f030a79b25e0798f2a69a8d0e7dcb606821d7489c56ee9fb6/guarddog-0.1.4.tar.gz",
                "yanked": false,
                "yanked_reason": null
            }
        ],
        "vulnerabilities": [
            {
                "aliases": [],
                "details": "### Impact\n\nRunning GuardDog against a specially-crafted package can allow an attacker to write an arbitrary file on the machine where GuardDog is executed.\n\nThis is due to a path traversal vulnerability when extracting the `.tar.gz` file of the package being scanned, which exists by design in the `tarfile.TarFile.extractall` function. See also https://docs.python.org/3/library/tarfile.html#tarfile.TarFile.extractall\n\n### Remediation\n\nUpgrade to GuardDog v0.1.5 or more recent.\n\n### References\n\n* https://semgrep.dev/r?q=trailofbits.python.tarfile-extractall-traversal.tarfile-extractall-traversal\n* https://www.trellix.com/en-us/about/newsroom/stories/research/tarfile-exploiting-the-world.html\n* https://docs.python.org/3/library/tarfile.html#tarfile.TarFile.extractall\n",
                "fixed_in": [
                    "0.1.5"
                ],
                "id": "GHSA-rp2v-v467-q9vq",
                "link": "https://osv.dev/vulnerability/GHSA-rp2v-v467-q9vq",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            },
            {
                "aliases": [],
                "details": "### Summary\n\nUnsafe extracting using `shutil.unpack_archive()` from a remotely retrieved tarball may lead to writing the extracted file to an unintended destination.\n\n### Details\n\nExtracting files using `shutil.unpack_archive()` from a potentially malicious tarball without validating that the destination file path is within the intended destination directory can cause files outside the destination directory to be overwritten.  \n\nThe vulnerable code snippet is between [L153..158](https://github.com/DataDog/guarddog/blob/a1d064ceb09d39bb28deb6972bc0a278756ea91f/guarddog/scanners/package_scanner.py#L153..158). \n\n```python\nresponse = requests.get(url, stream=True)\n\nwith open(zippath, \"wb\") as f:\n      f.write(response.raw.read())\n\nshutil.unpack_archive(zippath, unzippedpath)\n```\nIt seems that a remotely retrieved tarball which could be with the extension `.tar.gz` happens to be unpacked using `shutil.unpack_archive()` with no destination verification/limitation of the extracted files.\n\n### PoC\n\nThe PoC provided showcases the risk of extracting the non-harmless text file `sim4n6.txt` to a parent location rather than the current folder. \n\n```bash\n> tar --list -f archive.tar\ntar: Removing leading `../../../' from member names\n../../../sim4n6.txt\n\n> python3 \nPython 3.10.6 (main, Nov  2 2022, 18:53:38) [GCC 11.3.0] on linux\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n>>> import shutil\n>>> shutil.unpack_archive(\"archive.tar\")\n>>> exit()\n\n> file ../../../sim4n6.txt\n../../../sim4n6.txt: ASCII text\n```\n\n### A Potential Attack Scenario\n\n- An attacker may craft a malicious tarball with a filename path, such as `../../../../../../../../etc/passwd`, and then serve the archive remotely, thus, providing a possibility to overwrite the system files.\n\n### Mitigation\n\nPotential mitigation could be to:\n- Use a safer module, like `zipfile`.\n- Validate the location of the extracted files and discard those with malicious paths such as a relative path `..` or absolute ones. ",
                "fixed_in": [
                    "0.1.8"
                ],
                "id": "GHSA-78m5-jpmf-ch7v",
                "link": "https://osv.dev/vulnerability/GHSA-78m5-jpmf-ch7v",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            }
        ]
    },
    "0.1.5": {
        "info": {
            "author": "Ellen Wang",
            "author_email": "",
            "bugtrack_url": null,
            "classifiers": [
                "License :: OSI Approved :: Apache Software License",
                "Programming Language :: Python :: 3",
                "Programming Language :: Python :: 3.10",
                "Programming Language :: Python :: 3.11",
                "Programming Language :: Python :: 3.9"
            ],
            "description_content_type": "text/x-rst",
            "docs_url": null,
            "download_url": "",
            "downloads": {
                "last_day": -1,
                "last_month": -1,
                "last_week": -1
            },
            "home_page": "",
            "keywords": "",
            "license": "Apache-2.0",
            "maintainer": "",
            "maintainer_email": "",
            "name": "guarddog",
            "package_url": "https://pypi.org/project/guarddog/",
            "platform": null,
            "project_url": "https://pypi.org/project/guarddog/",
            "project_urls": null,
            "release_url": "https://pypi.org/project/guarddog/0.1.5/",
            "requires_dist": [
                "attrs (==21.4.0)",
                "boltons (==21.0.0)",
                "bracex (==2.3.post1)",
                "charset-normalizer (==2.1.0)",
                "click (==8.1.3)",
                "click-option-group (==0.5.3)",
                "colorama (==0.4.5)",
                "defusedxml (==0.7.1)",
                "docker (==6.0.0b1)",
                "face (==20.1.1)",
                "flake8 (>=5.0.4,<6.0.0)",
                "glom (==22.1.0)",
                "idna (==3.3)",
                "jsonschema (==4.9.1)",
                "mypy-extensions (==0.4.3)",
                "pathos (>=0.2.9,<0.3.0)",
                "pathspec (==0.9.0)",
                "platformdirs (==2.5.2)",
                "pyparsing (==3.0.9)",
                "pytest (>=7.1.2,<8.0.0)",
                "python-dateutil (==2.8.2)",
                "python-dotenv (==0.20.0)",
                "python-lsp-jsonrpc (==1.0.0)",
                "python-whois (>=0.8.0,<0.9.0)",
                "requests (==2.28.1)",
                "semgrep (==0.112.1)",
                "setuptools (>=65.6.3,<66.0.0)",
                "six (==1.16.0)",
                "tarsafe (>=0.0.4,<0.0.5)",
                "termcolor (>=2.1.0,<3.0.0)",
                "tomli (==2.0.1)",
                "tqdm (==4.64.0)",
                "typing-extensions (==4.3.0)",
                "ujson (==5.4.0)",
                "urllib3 (==1.26.11)",
                "wcmatch (==8.4)",
                "websocket-client (==1.3.3)"
            ],
            "requires_python": ">=3.9,<4",
            "summary": "GuardDog is a CLI tool to Identify malicious PyPI packages",
            "version": "0.1.5",
            "yanked": false,
            "yanked_reason": null
        },
        "last_serial": 16072240,
        "urls": [
            {
                "comment_text": "",
                "digests": {
                    "md5": "07784eab68e41fda74b60146f13f58b1",
                    "sha256": "58a344f2617dd057b3f74fe4500e28f86ada689047dd888e3c4e37d4bfe281a5"
                },
                "downloads": -1,
                "filename": "guarddog-0.1.5-py3-none-any.whl",
                "has_sig": false,
                "md5_digest": "07784eab68e41fda74b60146f13f58b1",
                "packagetype": "bdist_wheel",
                "python_version": "py3",
                "requires_python": ">=3.9,<4",
                "size": 87331,
                "upload_time": "2022-11-29T10:33:06",
                "upload_time_iso_8601": "2022-11-29T10:33:06.464105Z",
                "url": "https://files.pythonhosted.org/packages/92/3f/bef16d0b9ea1793302a26f62a123c2f10fb9e39a772a93b8cb2cf942691d/guarddog-0.1.5-py3-none-any.whl",
                "yanked": false,
                "yanked_reason": null
            },
            {
                "comment_text": "",
                "digests": {
                    "md5": "ac955763778ff72ce23ec9084d461e7e",
                    "sha256": "fe132cec230b83f7c7c27ad1ccfcfefaf8e37ed466e8450262e41c7aa55aab2d"
                },
                "downloads": -1,
                "filename": "guarddog-0.1.5.tar.gz",
                "has_sig": false,
                "md5_digest": "ac955763778ff72ce23ec9084d461e7e",
                "packagetype": "sdist",
                "python_version": "source",
                "requires_python": ">=3.9,<4",
                "size": 80098,
                "upload_time": "2022-11-29T10:33:07",
                "upload_time_iso_8601": "2022-11-29T10:33:07.789860Z",
                "url": "https://files.pythonhosted.org/packages/6a/b2/2997b14da566f93f48582dfaf2ff880d11a5f945f5d96ff8af252a696c48/guarddog-0.1.5.tar.gz",
                "yanked": false,
                "yanked_reason": null
            }
        ],
        "vulnerabilities": [
            {
                "aliases": [],
                "details": "### Summary\n\nUnsafe extracting using `shutil.unpack_archive()` from a remotely retrieved tarball may lead to writing the extracted file to an unintended destination.\n\n### Details\n\nExtracting files using `shutil.unpack_archive()` from a potentially malicious tarball without validating that the destination file path is within the intended destination directory can cause files outside the destination directory to be overwritten.  \n\nThe vulnerable code snippet is between [L153..158](https://github.com/DataDog/guarddog/blob/a1d064ceb09d39bb28deb6972bc0a278756ea91f/guarddog/scanners/package_scanner.py#L153..158). \n\n```python\nresponse = requests.get(url, stream=True)\n\nwith open(zippath, \"wb\") as f:\n      f.write(response.raw.read())\n\nshutil.unpack_archive(zippath, unzippedpath)\n```\nIt seems that a remotely retrieved tarball which could be with the extension `.tar.gz` happens to be unpacked using `shutil.unpack_archive()` with no destination verification/limitation of the extracted files.\n\n### PoC\n\nThe PoC provided showcases the risk of extracting the non-harmless text file `sim4n6.txt` to a parent location rather than the current folder. \n\n```bash\n> tar --list -f archive.tar\ntar: Removing leading `../../../' from member names\n../../../sim4n6.txt\n\n> python3 \nPython 3.10.6 (main, Nov  2 2022, 18:53:38) [GCC 11.3.0] on linux\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n>>> import shutil\n>>> shutil.unpack_archive(\"archive.tar\")\n>>> exit()\n\n> file ../../../sim4n6.txt\n../../../sim4n6.txt: ASCII text\n```\n\n### A Potential Attack Scenario\n\n- An attacker may craft a malicious tarball with a filename path, such as `../../../../../../../../etc/passwd`, and then serve the archive remotely, thus, providing a possibility to overwrite the system files.\n\n### Mitigation\n\nPotential mitigation could be to:\n- Use a safer module, like `zipfile`.\n- Validate the location of the extracted files and discard those with malicious paths such as a relative path `..` or absolute ones. ",
                "fixed_in": [
                    "0.1.8"
                ],
                "id": "GHSA-78m5-jpmf-ch7v",
                "link": "https://osv.dev/vulnerability/GHSA-78m5-jpmf-ch7v",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            }
        ]
    },
    "0.1.6": {
        "info": {
            "author": "Ellen Wang",
            "author_email": "",
            "bugtrack_url": null,
            "classifiers": [
                "License :: OSI Approved :: Apache Software License",
                "Programming Language :: Python :: 3",
                "Programming Language :: Python :: 3.10",
                "Programming Language :: Python :: 3.11",
                "Programming Language :: Python :: 3.9"
            ],
            "description_content_type": "text/x-rst",
            "docs_url": null,
            "download_url": "",
            "downloads": {
                "last_day": -1,
                "last_month": -1,
                "last_week": -1
            },
            "home_page": "",
            "keywords": "",
            "license": "Apache-2.0",
            "maintainer": "",
            "maintainer_email": "",
            "name": "guarddog",
            "package_url": "https://pypi.org/project/guarddog/",
            "platform": null,
            "project_url": "https://pypi.org/project/guarddog/",
            "project_urls": null,
            "release_url": "https://pypi.org/project/guarddog/0.1.6/",
            "requires_dist": [
                "attrs (==21.4.0)",
                "boltons (==21.0.0)",
                "bracex (==2.3.post1)",
                "charset-normalizer (==2.1.0)",
                "click (==8.1.3)",
                "click-option-group (==0.5.3)",
                "colorama (==0.4.5)",
                "defusedxml (==0.7.1)",
                "docker (==6.0.0b1)",
                "face (==20.1.1)",
                "flake8 (>=5.0.4,<6.0.0)",
                "glom (==22.1.0)",
                "idna (==3.3)",
                "jsonschema (==4.9.1)",
                "mypy-extensions (==0.4.3)",
                "pathos (>=0.2.9,<0.3.0)",
                "pathspec (==0.9.0)",
                "platformdirs (==2.5.2)",
                "pyparsing (==3.0.9)",
                "pytest (>=7.1.2,<8.0.0)",
                "python-dateutil (==2.8.2)",
                "python-dotenv (==0.20.0)",
                "python-lsp-jsonrpc (==1.0.0)",
                "python-whois (>=0.8.0,<0.9.0)",
                "requests (==2.28.1)",
                "semgrep (==0.112.1)",
                "setuptools (>=65.6.3,<66.0.0)",
                "six (==1.16.0)",
                "tarsafe (>=0.0.4,<0.0.5)",
                "termcolor (>=2.1.0,<3.0.0)",
                "tomli (==2.0.1)",
                "tqdm (==4.64.0)",
                "typing-extensions (==4.3.0)",
                "ujson (==5.4.0)",
                "urllib3 (==1.26.11)",
                "wcmatch (==8.4)",
                "websocket-client (==1.3.3)"
            ],
            "requires_python": ">=3.9,<4",
            "summary": "GuardDog is a CLI tool to Identify malicious PyPI packages",
            "version": "0.1.6",
            "yanked": false,
            "yanked_reason": null
        },
        "last_serial": 16072240,
        "urls": [
            {
                "comment_text": "",
                "digests": {
                    "md5": "3129a5193dcafbd88f133a99f8a78f3d",
                    "sha256": "ca5b564cfd06481eeaf61f73abfa6541f96eec7619814bdf4197d9ecdf618678"
                },
                "downloads": -1,
                "filename": "guarddog-0.1.6-py3-none-any.whl",
                "has_sig": false,
                "md5_digest": "3129a5193dcafbd88f133a99f8a78f3d",
                "packagetype": "bdist_wheel",
                "python_version": "py3",
                "requires_python": ">=3.9,<4",
                "size": 87331,
                "upload_time": "2022-11-29T21:16:42",
                "upload_time_iso_8601": "2022-11-29T21:16:42.343293Z",
                "url": "https://files.pythonhosted.org/packages/6e/1e/470e00d8519ff6a2443e61c72caff2ccb0e29f1205366f33312b2c03c0c0/guarddog-0.1.6-py3-none-any.whl",
                "yanked": false,
                "yanked_reason": null
            },
            {
                "comment_text": "",
                "digests": {
                    "md5": "cf7456aaa0e0dfd1ba7cd71a81f8c782",
                    "sha256": "4e1f5f895c357428a639a598aabe14e67270dec66bbcc03661e1b1422ab5d3f0"
                },
                "downloads": -1,
                "filename": "guarddog-0.1.6.tar.gz",
                "has_sig": false,
                "md5_digest": "cf7456aaa0e0dfd1ba7cd71a81f8c782",
                "packagetype": "sdist",
                "python_version": "source",
                "requires_python": ">=3.9,<4",
                "size": 80088,
                "upload_time": "2022-11-29T21:16:43",
                "upload_time_iso_8601": "2022-11-29T21:16:43.510034Z",
                "url": "https://files.pythonhosted.org/packages/fb/0a/92254630751f5a2a271326c22905963beb91072230b8cf4a7380db62f161/guarddog-0.1.6.tar.gz",
                "yanked": false,
                "yanked_reason": null
            }
        ],
        "vulnerabilities": [
            {
                "aliases": [],
                "details": "### Summary\n\nUnsafe extracting using `shutil.unpack_archive()` from a remotely retrieved tarball may lead to writing the extracted file to an unintended destination.\n\n### Details\n\nExtracting files using `shutil.unpack_archive()` from a potentially malicious tarball without validating that the destination file path is within the intended destination directory can cause files outside the destination directory to be overwritten.  \n\nThe vulnerable code snippet is between [L153..158](https://github.com/DataDog/guarddog/blob/a1d064ceb09d39bb28deb6972bc0a278756ea91f/guarddog/scanners/package_scanner.py#L153..158). \n\n```python\nresponse = requests.get(url, stream=True)\n\nwith open(zippath, \"wb\") as f:\n      f.write(response.raw.read())\n\nshutil.unpack_archive(zippath, unzippedpath)\n```\nIt seems that a remotely retrieved tarball which could be with the extension `.tar.gz` happens to be unpacked using `shutil.unpack_archive()` with no destination verification/limitation of the extracted files.\n\n### PoC\n\nThe PoC provided showcases the risk of extracting the non-harmless text file `sim4n6.txt` to a parent location rather than the current folder. \n\n```bash\n> tar --list -f archive.tar\ntar: Removing leading `../../../' from member names\n../../../sim4n6.txt\n\n> python3 \nPython 3.10.6 (main, Nov  2 2022, 18:53:38) [GCC 11.3.0] on linux\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n>>> import shutil\n>>> shutil.unpack_archive(\"archive.tar\")\n>>> exit()\n\n> file ../../../sim4n6.txt\n../../../sim4n6.txt: ASCII text\n```\n\n### A Potential Attack Scenario\n\n- An attacker may craft a malicious tarball with a filename path, such as `../../../../../../../../etc/passwd`, and then serve the archive remotely, thus, providing a possibility to overwrite the system files.\n\n### Mitigation\n\nPotential mitigation could be to:\n- Use a safer module, like `zipfile`.\n- Validate the location of the extracted files and discard those with malicious paths such as a relative path `..` or absolute ones. ",
                "fixed_in": [
                    "0.1.8"
                ],
                "id": "GHSA-78m5-jpmf-ch7v",
                "link": "https://osv.dev/vulnerability/GHSA-78m5-jpmf-ch7v",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            }
        ]
    },
    "0.1.7": {
        "info": {
            "author": "Ellen Wang",
            "author_email": "",
            "bugtrack_url": null,
            "classifiers": [
                "License :: OSI Approved :: Apache Software License",
                "Programming Language :: Python :: 3",
                "Programming Language :: Python :: 3.10",
                "Programming Language :: Python :: 3.11",
                "Programming Language :: Python :: 3.9"
            ],
            "description_content_type": "text/x-rst",
            "docs_url": null,
            "download_url": "",
            "downloads": {
                "last_day": -1,
                "last_month": -1,
                "last_week": -1
            },
            "home_page": "",
            "keywords": "",
            "license": "Apache-2.0",
            "maintainer": "",
            "maintainer_email": "",
            "name": "guarddog",
            "package_url": "https://pypi.org/project/guarddog/",
            "platform": null,
            "project_url": "https://pypi.org/project/guarddog/",
            "project_urls": null,
            "release_url": "https://pypi.org/project/guarddog/0.1.7/",
            "requires_dist": [
                "attrs (==21.4.0)",
                "boltons (==21.0.0)",
                "bracex (==2.3.post1)",
                "charset-normalizer (==2.1.0)",
                "click (==8.1.3)",
                "click-option-group (==0.5.3)",
                "colorama (==0.4.5)",
                "defusedxml (==0.7.1)",
                "docker (==6.0.0b1)",
                "face (==20.1.1)",
                "flake8 (>=5.0.4,<6.0.0)",
                "glom (==22.1.0)",
                "idna (==3.3)",
                "jsonschema (==4.9.1)",
                "mypy-extensions (==0.4.3)",
                "pathos (>=0.2.9,<0.3.0)",
                "pathspec (==0.9.0)",
                "platformdirs (==2.5.2)",
                "pyparsing (==3.0.9)",
                "pytest (>=7.1.2,<8.0.0)",
                "python-dateutil (==2.8.2)",
                "python-dotenv (==0.20.0)",
                "python-lsp-jsonrpc (==1.0.0)",
                "python-whois (>=0.8.0,<0.9.0)",
                "requests (==2.28.1)",
                "semgrep (==0.112.1)",
                "setuptools (>=65.6.3,<66.0.0)",
                "six (==1.16.0)",
                "tarsafe (>=0.0.4,<0.0.5)",
                "termcolor (>=2.1.0,<3.0.0)",
                "tomli (==2.0.1)",
                "tqdm (==4.64.0)",
                "typing-extensions (==4.3.0)",
                "ujson (==5.4.0)",
                "urllib3 (==1.26.11)",
                "wcmatch (==8.4)",
                "websocket-client (==1.3.3)"
            ],
            "requires_python": ">=3.9,<4",
            "summary": "GuardDog is a CLI tool to Identify malicious PyPI packages",
            "version": "0.1.7",
            "yanked": false,
            "yanked_reason": null
        },
        "last_serial": 16072240,
        "urls": [
            {
                "comment_text": "",
                "digests": {
                    "md5": "05e71db6a03de3392611757fd99fa123",
                    "sha256": "42df14eb517917ef70d44ac09d1c1e50cd92ae1a7f1408897be8cc6503d642ae"
                },
                "downloads": -1,
                "filename": "guarddog-0.1.7-py3-none-any.whl",
                "has_sig": false,
                "md5_digest": "05e71db6a03de3392611757fd99fa123",
                "packagetype": "bdist_wheel",
                "python_version": "py3",
                "requires_python": ">=3.9,<4",
                "size": 87474,
                "upload_time": "2022-12-01T08:40:22",
                "upload_time_iso_8601": "2022-12-01T08:40:22.772522Z",
                "url": "https://files.pythonhosted.org/packages/ca/19/6a3138dbb04d04f027783522f4fbc29017e9f0eb144e080f30cc8b196e84/guarddog-0.1.7-py3-none-any.whl",
                "yanked": false,
                "yanked_reason": null
            },
            {
                "comment_text": "",
                "digests": {
                    "md5": "1d68772432ce37c8431d454883784f86",
                    "sha256": "543ce714fcc40babc57a2da4488b0881198e9e47442dc796ea962a0230ba8d3c"
                },
                "downloads": -1,
                "filename": "guarddog-0.1.7.tar.gz",
                "has_sig": false,
                "md5_digest": "1d68772432ce37c8431d454883784f86",
                "packagetype": "sdist",
                "python_version": "source",
                "requires_python": ">=3.9,<4",
                "size": 80230,
                "upload_time": "2022-12-01T08:40:24",
                "upload_time_iso_8601": "2022-12-01T08:40:24.023903Z",
                "url": "https://files.pythonhosted.org/packages/a8/63/315826812f957960a8ea96f254637c4bdf0784ea6111e317707928bdc89f/guarddog-0.1.7.tar.gz",
                "yanked": false,
                "yanked_reason": null
            }
        ],
        "vulnerabilities": [
            {
                "aliases": [],
                "details": "### Summary\n\nUnsafe extracting using `shutil.unpack_archive()` from a remotely retrieved tarball may lead to writing the extracted file to an unintended destination.\n\n### Details\n\nExtracting files using `shutil.unpack_archive()` from a potentially malicious tarball without validating that the destination file path is within the intended destination directory can cause files outside the destination directory to be overwritten.  \n\nThe vulnerable code snippet is between [L153..158](https://github.com/DataDog/guarddog/blob/a1d064ceb09d39bb28deb6972bc0a278756ea91f/guarddog/scanners/package_scanner.py#L153..158). \n\n```python\nresponse = requests.get(url, stream=True)\n\nwith open(zippath, \"wb\") as f:\n      f.write(response.raw.read())\n\nshutil.unpack_archive(zippath, unzippedpath)\n```\nIt seems that a remotely retrieved tarball which could be with the extension `.tar.gz` happens to be unpacked using `shutil.unpack_archive()` with no destination verification/limitation of the extracted files.\n\n### PoC\n\nThe PoC provided showcases the risk of extracting the non-harmless text file `sim4n6.txt` to a parent location rather than the current folder. \n\n```bash\n> tar --list -f archive.tar\ntar: Removing leading `../../../' from member names\n../../../sim4n6.txt\n\n> python3 \nPython 3.10.6 (main, Nov  2 2022, 18:53:38) [GCC 11.3.0] on linux\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n>>> import shutil\n>>> shutil.unpack_archive(\"archive.tar\")\n>>> exit()\n\n> file ../../../sim4n6.txt\n../../../sim4n6.txt: ASCII text\n```\n\n### A Potential Attack Scenario\n\n- An attacker may craft a malicious tarball with a filename path, such as `../../../../../../../../etc/passwd`, and then serve the archive remotely, thus, providing a possibility to overwrite the system files.\n\n### Mitigation\n\nPotential mitigation could be to:\n- Use a safer module, like `zipfile`.\n- Validate the location of the extracted files and discard those with malicious paths such as a relative path `..` or absolute ones. ",
                "fixed_in": [
                    "0.1.8"
                ],
                "id": "GHSA-78m5-jpmf-ch7v",
                "link": "https://osv.dev/vulnerability/GHSA-78m5-jpmf-ch7v",
                "source": "osv",
                "summary": null,
                "withdrawn": null
            }
        ]
    },
    "0.1.8": {
        "info": {
            "author": "Ellen Wang",
            "author_email": "",
            "bugtrack_url": null,
            "classifiers": [
                "License :: OSI Approved :: Apache Software License",
                "Programming Language :: Python :: 3",
                "Programming Language :: Python :: 3.10",
                "Programming Language :: Python :: 3.11"
            ],
            "description_content_type": "text/x-rst",
            "docs_url": null,
            "download_url": "",
            "downloads": {
                "last_day": -1,
                "last_month": -1,
                "last_week": -1
            },
            "home_page": "https://github.com/DataDog/guarddog",
            "keywords": "",
            "license": "Apache-2.0",
            "maintainer": "",
            "maintainer_email": "",
            "name": "guarddog",
            "package_url": "https://pypi.org/project/guarddog/",
            "platform": null,
            "project_url": "https://pypi.org/project/guarddog/",
            "project_urls": {
                "Homepage": "https://github.com/DataDog/guarddog",
                "Repository": "https://github.com/DataDog/guarddog"
            },
            "release_url": "https://pypi.org/project/guarddog/0.1.8/",
            "requires_dist": [
                "attrs (==21.4.0)",
                "boltons (==21.0.0)",
                "bracex (==2.3.post1)",
                "charset-normalizer (==2.1.0)",
                "click (==8.1.3)",
                "click-option-group (==0.5.3)",
                "colorama (==0.4.5)",
                "defusedxml (==0.7.1)",
                "docker (==6.0.0b1)",
                "face (==20.1.1)",
                "flake8 (>=5.0.4,<6.0.0)",
                "glom (==22.1.0)",
                "idna (==3.3)",
                "jsonschema (==4.9.1)",
                "mypy-extensions (==0.4.3)",
                "pathos (>=0.2.9,<0.3.0)",
                "pathspec (==0.9.0)",
                "platformdirs (==2.5.2)",
                "pyparsing (==3.0.9)",
                "pytest (>=7.1.2,<8.0.0)",
                "python-dateutil (==2.8.2)",
                "python-dotenv (==0.20.0)",
                "python-lsp-jsonrpc (==1.0.0)",
                "python-whois (>=0.8.0,<0.9.0)",
                "requests (==2.28.1)",
                "semgrep (==0.112.1)",
                "setuptools (>=65.6.3,<66.0.0)",
                "six (==1.16.0)",
                "tarsafe (>=0.0.4,<0.0.5)",
                "termcolor (>=2.1.0,<3.0.0)",
                "tomli (==2.0.1)",
                "tqdm (==4.64.0)",
                "typing-extensions (==4.3.0)",
                "ujson (==5.4.0)",
                "urllib3 (==1.26.11)",
                "wcmatch (==8.4)",
                "websocket-client (==1.3.3)"
            ],
            "requires_python": ">=3.10",
            "summary": "GuardDog is a CLI tool to Identify malicious PyPI packages",
            "version": "0.1.8",
            "yanked": false,
            "yanked_reason": null
        },
        "last_serial": 16072240,
        "urls": [
            {
                "comment_text": "",
                "digests": {
                    "md5": "f771970c98af29550004d7b39704b2d4",
                    "sha256": "fef6e2761f14131c71d356698b88d3d73dcc4dc0b4bdddeaa061696bb3d8841a"
                },
                "downloads": -1,
                "filename": "guarddog-0.1.8-py3-none-any.whl",
                "has_sig": false,
                "md5_digest": "f771970c98af29550004d7b39704b2d4",
                "packagetype": "bdist_wheel",
                "python_version": "py3",
                "requires_python": ">=3.10",
                "size": 87759,
                "upload_time": "2022-12-05T16:10:19",
                "upload_time_iso_8601": "2022-12-05T16:10:19.760085Z",
                "url": "https://files.pythonhosted.org/packages/5f/7b/c0ddba07dc5896af8e09eddce6c824ee416a230e60a2c230c363e0378a56/guarddog-0.1.8-py3-none-any.whl",
                "yanked": false,
                "yanked_reason": null
            },
            {
                "comment_text": "",
                "digests": {
                    "md5": "bdcd2e290de96393bf1137924ff0519e",
                    "sha256": "ee1346bf4935ac3756b7a12faa4da980ee17f399f7d80415fc1ac92edce210e2"
                },
                "downloads": -1,
                "filename": "guarddog-0.1.8.tar.gz",
                "has_sig": false,
                "md5_digest": "bdcd2e290de96393bf1137924ff0519e",
                "packagetype": "sdist",
                "python_version": "source",
                "requires_python": ">=3.10",
                "size": 80499,
                "upload_time": "2022-12-05T16:10:21",
                "upload_time_iso_8601": "2022-12-05T16:10:21.846693Z",
                "url": "https://files.pythonhosted.org/packages/e9/00/4379b16f0283d783fcd51192dd7a82a033e3bed3577e4388c61aa83ed71e/guarddog-0.1.8.tar.gz",
                "yanked": false,
                "yanked_reason": null
            }
        ],
        "vulnerabilities": []
    },
    "0.1.9": {
        "info": {
            "author": "Ellen Wang",
            "author_email": "",
            "bugtrack_url": null,
            "classifiers": [
                "License :: OSI Approved :: Apache Software License",
                "Programming Language :: Python :: 3",
                "Programming Language :: Python :: 3.10",
                "Programming Language :: Python :: 3.11"
            ],
            "description": "# GuardDog\n\nSee https://github.com/datadog/guarddog\n\n",
            "description_content_type": "text/x-rst",
            "docs_url": null,
            "download_url": "",
            "downloads": {
                "last_day": -1,
                "last_month": -1,
                "last_week": -1
            },
            "home_page": "https://github.com/DataDog/guarddog",
            "keywords": "",
            "license": "Apache-2.0",
            "maintainer": "",
            "maintainer_email": "",
            "name": "guarddog",
            "package_url": "https://pypi.org/project/guarddog/",
            "platform": null,
            "project_url": "https://pypi.org/project/guarddog/",
            "project_urls": {
                "Homepage": "https://github.com/DataDog/guarddog",
                "Repository": "https://github.com/DataDog/guarddog"
            },
            "release_url": "https://pypi.org/project/guarddog/0.1.9/",
            "requires_dist": [
                "attrs (==21.4.0)",
                "boltons (==21.0.0)",
                "bracex (==2.3.post1)",
                "charset-normalizer (==2.1.0)",
                "click (==8.1.3)",
                "click-option-group (==0.5.3)",
                "colorama (==0.4.5)",
                "defusedxml (==0.7.1)",
                "docker (==6.0.0b1)",
                "face (==20.1.1)",
                "flake8 (>=5.0.4,<6.0.0)",
                "glom (==22.1.0)",
                "idna (==3.3)",
                "jsonschema (==4.9.1)",
                "mypy-extensions (==0.4.3)",
                "pathos (>=0.2.9,<0.3.0)",
                "pathspec (==0.9.0)",
                "platformdirs (==2.5.2)",
                "pyparsing (==3.0.9)",
                "pytest (>=7.1.2,<8.0.0)",
                "python-dateutil (==2.8.2)",
                "python-dotenv (==0.20.0)",
                "python-lsp-jsonrpc (==1.0.0)",
                "python-whois (>=0.8.0,<0.9.0)",
                "requests (==2.28.1)",
                "semgrep (==0.112.1)",
                "setuptools (>=65.6.3,<66.0.0)",
                "six (==1.16.0)",
                "tarsafe (>=0.0.4,<0.0.5)",
                "termcolor (>=2.1.0,<3.0.0)",
                "tomli (==2.0.1)",
                "tqdm (==4.64.0)",
                "typing-extensions (==4.3.0)",
                "ujson (==5.4.0)",
                "urllib3 (==1.26.11)",
                "wcmatch (==8.4)",
                "websocket-client (==1.3.3)"
            ],
            "requires_python": ">=3.10",
            "summary": "GuardDog is a CLI tool to Identify malicious PyPI packages",
            "version": "0.1.9",
            "yanked": false,
            "yanked_reason": null
        },
        "last_serial": 16072240,
        "urls": [
            {
                "comment_text": "",
                "digests": {
                    "md5": "cf96c6cc5f4e8482cc35b97ee6ab3927",
                    "sha256": "5b27d6ca58982e2e3a5ebee06521384824eb801438a8a6d80c3da0138d286613"
                },
                "downloads": -1,
                "filename": "guarddog-0.1.9-py3-none-any.whl",
                "has_sig": false,
                "md5_digest": "cf96c6cc5f4e8482cc35b97ee6ab3927",
                "packagetype": "bdist_wheel",
                "python_version": "py3",
                "requires_python": ">=3.10",
                "size": 88521,
                "upload_time": "2022-12-07T10:33:42",
                "upload_time_iso_8601": "2022-12-07T10:33:42.917124Z",
                "url": "https://files.pythonhosted.org/packages/0a/32/d6b52e16c0c4f760a8fc59c60108cfe5480cd0275dd3a2be0b89b786e27c/guarddog-0.1.9-py3-none-any.whl",
                "yanked": false,
                "yanked_reason": null
            },
            {
                "comment_text": "",
                "digests": {
                    "md5": "2796d9bc9312831f39514cf71bc96e8b",
                    "sha256": "07f2ab3e8ecd710fd72c2eba4972b467d6dcf41256798b2e59f56d8a9586bfcc"
                },
                "downloads": -1,
                "filename": "guarddog-0.1.9.tar.gz",
                "has_sig": false,
                "md5_digest": "2796d9bc9312831f39514cf71bc96e8b",
                "packagetype": "sdist",
                "python_version": "source",
                "requires_python": ">=3.10",
                "size": 80914,
                "upload_time": "2022-12-07T10:33:46",
                "upload_time_iso_8601": "2022-12-07T10:33:46.128180Z",
                "url": "https://files.pythonhosted.org/packages/2f/ef/05d961c0213f3d6ec4f7bbd43610be8c306356b9bb84851d47573395f83e/guarddog-0.1.9.tar.gz",
                "yanked": false,
                "yanked_reason": null
            }
        ],
        "vulnerabilities": []
    }
}